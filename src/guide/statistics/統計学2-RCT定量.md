## 同じ分布に含まれる2つの意味

前回は，集団Aからランダムサンプリングして集団Bをつくったとき，AとBはあらゆる性質において同じ分布，つまり同じ集団になるということを説明しました．しかし，それと同時に，では集団Bとして1人だけとか，2人だけとってきたときにできるものは，Aとは全く同じ分布にはならないということにも触れました．この一見矛盾する結果は，「同じ分布」という言葉を2つの異なる意味で使っていることに起因します．

- 同じ確率分布によって生成される
- 実際の分布(生成された分布，サンプリングされた分布)が(なんらかの基準で)似ている．

確率分布という言葉が出てきましたが，恐れる必要はありません．これまで扱ってきた分布とほとんど同じものです．

例えば，公平なサイコロを考えましょう．このサイコロを振ったときの出る目の確率分布は次のようなものです．

だから，サイコロを1回振った時には1/6の確率で1の目がでます．

これは，前回扱った母集団から一人をランダムサンプリングすると，n/mの確率でcmの人が得られるのと全く同じ話です．

つまり，前回の分布の縦軸を度数から確率に変換したものは確率分布と等しいわけです(もちろん，母集団の分布は確定しているものなので，度数を総数で割ったものは，割合にすぎません．しかし母集団からのサンプリングという視点で見ると，この割合分布は，ある値をとる確率を表していると見なせるので，確率分布とも呼べるということです)

そして，母集団からランダムサンプリングするごとに身長は，確率分布に従う確率でいろいろな値をとります．この意味で，サンプリングで得られる身長やサイコロの目を確率変数といいます．

~~そして，横軸の値，つまりサイコロの目や身長のことを確率変数といいます．というのも，これらの値は，いろいろな値を決まった確率でとるからです．~~

ここで正確な定義を導入します．確率分布とは「確率変数がある値をとる確率を定めた関数」で，確率変数とは「サンプルごとにとる値が確率的に変化する数」で，この例では「確率分布で与えられる確率に従って決まる数」です．この用語は非常に重要です．

ここで関数についておさらいしておきましょう．関数とは，あるものを他のものに対応させるもののことをいいます．学校で習う関数の多くは数式で表されますが，関数と数式は本来的には関係ありません．

「集団Aからランダムサンプリングして集団B,Cをつくったとき，BとCはあらゆる性質において同じ分布になる」というときに意味していることを正確に述べると，

- 二つのサンプルは，母集団の割合分布を確率分布として生成する．つまり，同じ確率分布から生成されている．

- このことに加えて，「十分なサンプル数があれば」実際に生成されるサンプルが「同じ形」になる．

  なので，例えばBのサンプル数が少ないときには，2の意味では同じ形にはなりませんが，同じ確率分布に従って作られていることには変わりありません．

どのくらいのサンプルがあれば2つ目の意味でも分布が同じと見なせるのか，という問題はおいておきましょう．

## 母集団の分布を，数学的な確率分布に当てはめる

さて，母集団は確定した集団で，それゆえに母集団の分布・割合分布は決まっています．

しかし，その分布をそのまま見て考えることには困難が伴います．

これを説明するために，色々な分布の例を見てみます．

例えば，17歳の日本人の身長の割合分布，青色が男子で赤色が女子です．これは全数調査なので，これは母集団の分布と見なせます．このとき，女子も男子も同じ形の分布(これは同じ分布という時の2の意味)をしていて，男子の分布は女子の分布を右にスライドさせたもの，つまり平均が大きくなったもの，と考えるのが自然でしょう．しかし，分布を生のまま見ると，厳密に右に平行移動した関係にはもちろんなっていないので，このような主張をすることができません．

![ファイル:17歳の日本人の身長の分布.jpg](https://upload.wikimedia.org/wikipedia/commons/thumb/7/74/17%E6%AD%B3%E3%81%AE%E6%97%A5%E6%9C%AC%E4%BA%BA%E3%81%AE%E8%BA%AB%E9%95%B7%E3%81%AE%E5%88%86%E5%B8%83.jpg/800px-17%E6%AD%B3%E3%81%AE%E6%97%A5%E6%9C%AC%E4%BA%BA%E3%81%AE%E8%BA%AB%E9%95%B7%E3%81%AE%E5%88%86%E5%B8%83.jpg)

身長と同じ形をした分布は，他にも色々あります．

例えば，子供の出生体重

![img](https://www.hokende.com/_images/fef26a38-fce0-4715-8ebb-8aed69e024b4/562f2334c1b75.png)

大学入試の得点

![img](https://prtimes.jp/i/30937/12/resize/d30937-12-235018-1.jpg)

沖縄の梅雨明けの日にち

![img](https://quest.urban-cafeteria.com/pictures/tuyuake2.jpg)

このような同じ形をした色々な母集団をみて，それが「同じ形をしている」と判断するために，次のように解決してみます．

サンプルが同じ分布という時に，同じ分布になることを保証するのは，

同じ確率分布から生成されていること，十分なサンプル数があることでした．

後者の条件は(今は母集団なのでサンプル数とは言いませんが)母集団がある程度大きいことは分かっているとして無視しましょう．

だから，これらの分布が同じ形をしていることを主張するためには，これらの母集団が，共通する確率分布をもっている(共通する確率分布から生成されている，共通する確率分布に近似できる)と考えれば良いわけです．そのような確率分布として正規分布を考えます．

## 正規分布

正規分布は数式で表された確率分布です．確率分布とは，それが数式で表されているにせよ，いないにせよ関数でした．だから，正規分布は数式で表された関数になります．

数式で表された関数であることが非常に重要なポイントです．

というのも，関数は数式で表されるのなら，関数の形をきめるパラメータが有限個しかないからです．

具体的に言うと，例えばy=ax+bという1次関数のグラフを考えます．

このとき，aとbがこの関数の形(=どういうグラフになるのか)を決めるパラメータです．つまり，a=1,b=-1のようにa,bの値を決めると，y=x-1という一つの決まったグラフができるからです．

問題 y= a^2x + bx + c という2次関数, (x-a)^2 + (y-b)^2 = r^2という円のパラメータは何？　結局，x-yグラフにかける関数なら，x,y以外の未知数が一つの数に確定すれば，xを代入した時にyの値も(複数個ある可能性はあるが)確定するので，グラフも確定する．だからx-yの平面グラフではx,y以外の未知数がパラメータと思えばいい．

同様に，正規分布の数式は以下のようになります．

この式は複雑ですが，パラメータが何かを考えてみます．すると，ミューとシグマがパラメータでこれを決めると，正規分布が一つの形に決まることが分かります．そこで，実際に動かしてみましょう．



動かしてみると分かるように，このグラフは，ミューの値がグラフの値が一番高くなっているちょうど真ん中に等しくなり，シグマの値は，山の幅を決めていることが分かります．

そうすると，例えば，男女の身長の分布については次のように言えそうです．

この分布は，シグマの値はほぼ同じで(山の幅は同じ)ミューの値だけが違うと．

また，赤ちゃんの身長の分布についても，シグマを ミューを とすれば，だいたい同じ形になるので，

こうして，異なる分布，しかし似ている分布の「同じさ，違いさ」を2つの値についてだけで考えることができるようになりました．これが確率分布を当てはめる，もっとも大きな利点です．

利点が分かったところで正規分布について，もう少し見ていきましょう．

再び身長の分布に例を取ります．このように，身長のもとの分布と，同じ形になる正規分布を考えた時に，縦軸の値は何になるのでしょうか？同じ形と言うぐらいなので，例えばもっとも高くなっている，170cmのところは，母集団の割合分布が示すように，xxくらいなのでしょうか．実はそうではありません．

正規分布の数式に例えばミューを代入すると，値は　になります．確率分布とは「」でしたから，正規分布からランダムサンプリングすると，値がミューになる確率が　になるということでしょうか．実はそうなっていないのです．そもそも正規分布において，xは連続的な値をとります．例えば身長も同様です．だから，ぴったり170という値をとることはありえません．母集団の割合分布でも割合はあくまでxxcm-yycmの人の割合であって，幅があることに注意してください．つまり連続的な値をとるものに関しては，ある特定の1つの値をとる確率をとることを考えることは不可能で，~の値をとる確率しか考えられないのです．これは例えば離散的な値をとるサイコロとの大きな違いです．

それゆえ，正規分布とランダムサンプリングによってある値になる確率は，次のように結びついています．

これは，つまり，グラフの面積が，その値をとる確率に結びついているわけです．ヒストグラムとの関連で言えば，ヒストグラムの幅が一定なら高さは，グラフの面積に比例しているので，縦軸の縮尺は違いますが，正規分布とヒストグラムは同じ形になります．だから割合分布の平均と，分散は近似する正規分布に一致します．

これは正規分布のように連続関数で表された確率分布全てに言えることです．

一方，例えばサイコロの目の分布は離散一様分布と呼ばれ，次のように，ある特定の1つの値をとる確率が表されることになります．一方連続一様分布であれば，正規分布と同じように　となるわけです．

確率分布について，そこから発生する確率変数の平均と分散を計算することができます．サイコロの例では，　　なので　．正規分布でも同様に計算できますが，これはただの計算なので省略しましょう．

統計を学習する時に重要なのは，計算と統計を切り離すことです．数学と統計を切り離しては統計は絶対に理解できませんが，計算を切り離しても本質的なところは理解できます．

## 破壊的標本調査の例でz検定 , t検定





分散が分からないときはどうするか？

t分布に従うことの意味をN(0,1)に従うことと同じようにイメージする．すなわち，N(0,1)のようにある確定した確率分布に従うことで，サンプルするごとに決まるこの値が，95%の確率で，特定の範囲内に入っていることが分かり，

だから，実際にt分布にこの値が従うことの証明は数学的な問題なので無視しても大丈夫．

t-分布の導出 https://qiita.com/s0sasaki/items/a27e743251218777e343

t-分布の数式 https://ja.wikipedia.org/wiki/T%E5%88%86%E5%B8%83



破壊的標本調査の例でz検定



## 薬Zの例で仮説検定

では薬Zの例に戻ります．5歳児の身長の分布は，17歳の例を踏まえると正規分布をとると考えて良さそうです．

そして，薬を使用した群と使用しない群は，効果があればミューが変化しているでしょう．シグマの変化については，とりあえず変化しないと考えることにしましょう．

そうすると，そこからランダムサンプリングしたサンプルもこの正規分布に従うわけです．

このとき，分かるのは投与群と非投与群のサンプルの平均と分散だけです．ここから母集団の投与群と非投与群の平均と分散を推定することになります．

別の言い方をすれば，サンプルが従う正規分布のパラメータをサンプルから推定するということです．このパラメータは母集団から一つ定まった値ですが，サンプルの平均と分散はサンプリングするたびに偶然誤差で色々な値を取ります．

M = Σ Xk / N

S^2 = 

Xk ~ N(μ，σ)

ここで，正規分布には次の性質があることを使います．



これも純粋に正規分布という関数の数学的な性質なので統計的には既知の事実として進む．

よって，平均は次の確率分布に従うことが分かる．





このように母集団を数式で表された確率分布に近似することを正当化する根拠を幾つか述べます．

- 





しかしそれを知り得るのは神様だけです．実際に私たちが得るものはすべてサンプルです．この2つの視点を交互に行き来することは統計を理解する上で非常に重要です．

つまり，確定しているけど知り得ないのが母集団であり，その分布なのです．だから，そこからいくらたくさんのサンプルをとってきても，



所得の分布(パレート?)

![平均年収の分布から対数正規分布と確率分布・確率変数について学ぼう | ２０代サラリーマンの全方位投資](https://i1.wp.com/toushi-channel.com/wp-content/uploads/2019/04/https___www_mhlw_go_jp_toukei_saikin_hw_k-tyosa_k-tyosa16_dl_03_pdf.png?resize=744%2C622)

身長の分布

https://www.google.com/url?sa=i&url=https%3A%2F%2Fja.wikipedia.org%2Fwiki%2F%25E3%2583%2595%25E3%2582%25A1%25E3%2582%25A4%25E3%2583%25AB%3A17%25E6%25AD%25B3%25E3%2581%25AE%25E6%2597%25A5%25E6%259C%25AC%25E4%25BA%25BA%25E3%2581%25AE%25E8%25BA%25AB%25E9%2595%25B7%25E3%2581%25AE%25E5%2588%2586%25E5%25B8%2583.jpg&psig=AOvVaw1RqMqTQ-7tSiHUEj_9EU7i&ust=1674215820319000&source=images&cd=vfe&ved=0CBAQjRxqFwoTCODw64vK0_wCFQAAAAAdAAAAABAE

子供の出生体重 https://www.hokende.com/_images/fef26a38-fce0-4715-8ebb-8aed69e024b4/562f2334c1b75.png

センター試験 https://prtimes.jp/main/html/rd/p/000000012.000030937.html

沖縄の梅雨明け https://quest.urban-cafeteria.com/tuyuake.html





・母集団は確定的な集団なのだが，数学的にあつかうためには，その構造について仮定を置く必要がある．そこで母集団もある確率分布と近似・同一と考える．そもそもサンプルしか知り得ない．だから母集団の分布の細かいところがどうこうということはそもそも分からない．大まかな構造(データがどのように生成されるのか)を考える．その確率分布のパラメータは母集団の性質を反映して一つに決まっている．最尤法的な考え方．

・母集団の分布はどうやって仮定すればいいか．サンプルから．もしくはとくに身長の分布は正規分布になる理由を生物学的に説明，ベルヌーイ分布と二項分布．

・サンプルはそれに従う確率変数である．サンプルごとに，統計量は異なる．だから，2集団の統計量の差が偶然ではない差なのかを調べる必要がある．

・逆に偶然の差とはなにか．それはどちらもプラセボに置き換えた場合で考えてみよう．(もちろんどちらも薬に置き換えても話は変わらない)この場合介入後の2つの母集団は同じ．ならサンプルの差は偶然のみの差．この差が特定の値になる確率は数学的に計算できる．

・実際の差が，もし差がなかったときにはほとんど生じないような差だったら・・・　・帰無仮説とP値と有意差と意義と信頼区間と標準誤差とサンプル数



キーワード　確率分布　統計量