---
layout: layouts/post.njk
---

母集団の生Data -> 母集団の分布(ヒストグラム)平均 -> サンプルの生データ -> サンプルの分布(ヒストグラム)平均

前回の問題点を身長のデータを使って確認．

- 母集団の分布とサンプルの分布は揺らぎのために必ずしも一致しない．そのため平均も一致せず，薬の効果も一致しない．
- サンプル数が多くなるほど揺らぎは小さくなる

これが問題だった．

「母集団の分布とサンプルの分布は揺らぎのために必ずしも一致しない」というときにやっていたのは，サンプルのヒストグラムと母集団のヒストグラムを比べること．しかし，そもそも母集団のヒストグラムの表し方には恣意性がある．つまり，階級の幅や区切りの付け方．幅を∞にすれば全て一致する．しかし細かくすればいいかといって，0に近づければデータがなくなる．丁度いい幅とはなにか？となる．区切りの位置は恣意的にならざる終えない．

bar一本一本が表していることを一般化すると，\\( P(a \leqq x \leqq b ) \\)となる．

だから，母集団の分布をヒストグラムで表すかわりに，

\\( p(a,b) =  P(a \leqq x \leqq b ) \\) 

となる，関数p(a,b)で表すことにすれば，恣意性がなくなる．

a,bが与えられたときに，母集団のデータから，p(a,b)を求めるためには，その区間にあるやつの数/母集団のデータ数とすればいいけど，
実際母集団は知り得ないし，データも無限にある可能性があるので，p(a,b)を数式で表せたらよい．
これができれば，170cm台の人の割合をヒストグラムで見ていたところを，p(170,171)として，計算すればいいことになる．計算は誰かがやってくれるだろう．

ではどんな数式になるか．

p(a,b)は，

\\( p(a,a) = 0 \\) ← ヒストグラムの幅を0に近づけたとき．
\\( p(a,b) + p(b,c) = p(a,c) \\) ← 確率の概念
\\( p(-∞,+∞) = 1 \\)  ← ヒストグラムの幅を∞にしたとき．

を満たす．

とくに2番目の性質は，a,b,cをx軸にとって，f(x)とx軸が囲む面積とすれば実現できるので，

\\[p(a,b) =  \int_{a}^{b} f(x) dx \\]

となるようなf(x)でp(a,b)を近似する．こうすれば，1番目は自動的に，3番目の条件は正規化条件となる．

どんなf(x)が適切なのか？それは正規分布であることが知られている．

正規分布の式．

正規分布を動かしてみる．パラメータが重要．

正規分布から，どんなヒストグラムでも生成できること，つまり正規分布は全てのヒストグラムを統合して恣意性を排して分布を表したものと解釈できることを説明．(bin_width = 1,2, ∞の場合，区切りの位置を変えても同じ)

では母集団が与えられたときに，それに，どんなμとσの正規分布を当てはめれば適切に分布を表せるのか．(そもそも母集団に正規分布をが当てはめられるのか，という問題はおいておく．適当なbin-widthで正規分布らしければいいとしておく)

結論としては母集団の平均μと正規分布のパラメータμを一致させ，母集団の標準偏差sと正規分布のパラメータsを一致させれば当てはめられる．
このことを，[平均の定義](https://www.kwansei.ac.jp/hs/z90010/sugakuc/toukei/avgvar/avgvar.htm)と，区分求積法を使って説明．https://univ-juken.com/kubun-kyusekihou の図を使う．区分求積法自体は[このサイト](https://hiraocafe.com/note/kubunkyuseki.html)や[youtubeの動画](https://www.youtube.com/watch?v=x-xeLzH5SUw)で理解してもらう．

- 正規分布の平均，標準偏差がμ,sであること
- ヒストグラムでの場合と，正規分布での場合の平均，分散の求め方は本質的に同じなのでグラフが一致すれば，それぞれが同じになること，逆にいえば，同じになれば，グラフが一致すること．

から説明．

以上から，母集団を正規分布で近似できることを説明．このようなステップで一般的に確率分布を当てはめる．手順としては母集団のヒストグラムやデータ生成プロセスから，どの確率分布が当てはめられそうかを考えて，うまく当てはまったときには縦軸の倍率を除いて，グラフが一致する(重なる)．しかし，母集団でやることはできないので実際はサンプルを使って実行して，サンプルの(ヒストグラムをつかって当てはめた)分布と母集団に当てはめた分布は同じであることを仮定する．

これで，母集団からのランダムサンプリングは，ある確率分布からのランダムサンプリングであることがわかる．
これを確率変数という．サンプルをN個とってきて平均などを計算する．これを統計量という．統計量と母統計量の違いは，統計量にはゆらぎ(サンプルごとの変動)があるということ．母統計量にはゆらぎはない．

ゆらぎを定量的に考えるためには，平均という統計量自体も確率変数であることを使う．つまり，平均はある確率分布に従うことになる．それは数学的に求められる．ここから区間推定，検定へ行く．




# ボツ
幅のヒストグラムで求める平均
\\( p(a,a+1) \cdot a+ \frac{1}{2} \\) 

\\( p(a,a+\frac{1}{2}) \cdot a+ \frac{1}{4} \\) 

\\( p(a,a+\delta) \cdot a+ \frac{\delta}{2} =  p(a,a+\delta) \cdot a  \\)  



知りたいのは，母集団のデータが与えられたときに，どんな正規分布を当てはめればいいのかということ．
例えば身長の場合でやってみる．しかし，μとσの値を確定させることは難しい．

一般には，以下の2つが問題．

- そもそも母集団に正規分布をが当てはめられるのか(この問題はおいておく．適当なbin-widthで正規分布らしければいいとしておく)
- 当てはめられるのであれば，μとσをどうすればいいか．(この問題を考える)