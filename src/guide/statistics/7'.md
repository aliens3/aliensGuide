---
layout: layouts/guide.njk
title: ランダムサンプル，サンプルサイズ，誤差
order : 4
tags: stat
---

## 7.9

サンプル平均$\overline{X}$について，

$$ \overline{X} \sim N(\mu,\frac{\sigma^{2}}{N}) $$

でした．さらに，事実Cを使えば，

$$ z = \frac{ \overline{X} - \mu }{\sqrt{\frac{\sigma^{2}}{N}}} \sim N(0,1) $$ 

が示せます． $N(0,1)$を**標準正規分布**といいます．

## 7.10

標準正規分布について見ていきます．標準正規分布の確率密度関数は，

$$f(x)= \frac{1}{\sqrt{2\pi}}e^{\frac {-x^2}{2}}$$ 

となります．

$X \sim N(0,1)$ のとき，a≦X≦bとなる確率 $P(a≦X≦b)$は，

$$\int_a^b f(x) dx$$

で求められますが，実際に自分で計算する必要はありません．[このサイト](https://www.geogebra.org/m/W9Nz53Ct)で色々なa,bを代入して$P(a≦X≦b)$を求めてみてください．とくに次の代表的な値はよく使います．

<img src="/img/stats/標準正規分布.png" alt="" srcset=""  url="https://en.wikipedia.org/wiki/Continuous_uniform_distribution" class="mr-0 ml-auto my-4" width="350px" >


## 7.11

以上の話を踏まえると，サンプル平均から母平均を定量的に推定することができます．まず，今までの話を簡単に復習します．

$N(μ, σ^2)$である母集団からランダムサンプルした$X_k \sim N(μ, σ^2)$について， $ \overline{X} \sim N(\mu,\frac{\sigma^{2}}{N}) $ で，

$$z = \frac{ \overline{X} - \mu }{\sqrt{\frac{\sigma^{2}}{N}}} \sim N(0,1)$$

でした．

ここで母平均と母分散を知っている神様なら，サンプルサイズNのサンプルを取り出すたびにzの値を具体的に求めることができます．こうして，サンプルをとることを繰り返して，zの分布をヒストグラムにしていけば，N(0,1)によく当てはまるものになります．

一方，私たちはμもσも知らないのでzの値を計算しようとしても，これらが未知数として残ってしまいます．

ここで，7.10の結果から，例えば$P(-1.96≦z≦1.96)= 0.95$ です．つまり，サンプルをたくさん集めてzの値を集めていくと，全体の95%のサンプルのzは-1.96から1.96の間に入るということです．

zに $\frac{ \overline{X} - \mu }{\sqrt{\frac{\sigma^{2}}{N}}}$を戻すと，

$$ P( -1.96 \leqq \frac{ \overline{X} - \mu }{\sqrt{\frac{\sigma^{2}}{N}}}  \leqq 1.96) = 0.95 $$ 

となります．これを式変形すると，

$$ P( \overline{X} -1.96\sqrt{\frac{\sigma^{2}}{N}}  \leqq \mu \leqq \overline{X} +1.96\sqrt{\frac{\sigma^{2}}{N}}) = 0.95 \tag{1}$$ 

となります．2つの式は，Pの中身を変形しただけなので数学的には全く同じことを意味するのですが，ここで視点を神様から私たちに移します．私たちにとっては，$\overline{X},N$だけが既知です．しかし，特別ボーナスで，母分散の値も神様から教えてもらえたとしましょう．

具体的に，集団Qをまた使って説明します．集団Qは母平均が100.50,母分散が4.3^2でした．

<img src="/img/stats/集団Qの身長分布.png" alt="" srcset="" class="mr-0 ml-auto my-4" width="450px" >


ここでサンプルサイズ100のサンプルを一つ取って次のようだったとします
．
<img src="/img/stats/区間推定のための集団Qからのサンプル.png" alt="" srcset="" class="mr-0 ml-auto my-4" width="450px" >
 
母分散は$4.3^2$だと神様に教えてもらえるので，$ \overline{X} = 101.1$ , $N = 100$ , $\sigma^2 = 4.3^2$を(1)に代入して計算すると，

$$ P( 100.3 \leqq \mu \leqq 101.9) = 0.95$$ 

が分かります．つまり，$100.3 \leqq \mu^D \leqq 101.9$が成り立つ確率は95%だということです．母分散を教えてもらうというインチキはしましたが，サンプル平均から母平均を誤差つきで推定することができています．


そして，その誤差の大きさは，どれだけの確信がほしいかで変わってきます．

例えば，$P(-1.96≦z≦1.96)= 0.95$ではなく，$P(-3≦z≦3)= 0.9974$を使うとどうなるでしょうか．

数値が違うだけなので計算は省略しますが，

$$ P( \overline{X} -3\sqrt{\frac{\sigma^{2}}{N}}  \leqq \mu \leqq \overline{X} +3\sqrt{\frac{\sigma^{2}}{N}}) = 0.9974 $$ 

から，同様に$ \overline{X} = 101.1$ , $N = 100$ , $\sigma^2 = 4.3^2$を代入して，

$$ P( 99.9 \leqq \mu \leqq 102.3) = 0.9974$$ 

となります．一般的には $a \leqq \mu \leqq b$が成り立つ確率を高くすればするほど，a,bの範囲は広くなっていくことが分かります．そしてその広くなり方は，$\sqrt{\frac{\sigma^{2}}{N}}$に依存していることが分かります．つまり，母分散が大きいほど(元々のデータの散らばりが大きいほど)，サンプルサイズが小さいほど，推定幅が大きくなってしまうわけです．

このような推定方法を**区間推定**といいます．そして，$P(a≦µ≦b)= 0.95$ となる区間$a≦µ≦b$ のことを母平均についての**95%信頼区間**といいます．一般に，$P(a≦µ≦b)= 1-α$ となる区間$a≦µ≦b$ のことを<b>(1-α)%信頼区間</b>といいます．このとき1-αを**信頼水準**と言います．

例えば，$P(-3≦z≦3)= 0.9974$を使った場合には，$ P( 88.2 \leqq \mu \leqq 114.1) = 0.9974$が求められたので，$88.2 \leqq \mu \leqq 114.1$は，99.74%信頼区間(1-α=0.9974なのでα=0.0026)となります．なぜ1-αという表記なのか，αとは何者なのかについては後ほど説明します．

## 7.12

母分散が未知の場合にどうするか，という問題に移る前に，

$a \leqq \mu \leqq b$が成り立つ確率は95%

というとき，これが意味しているところについて頻度主義的な解釈に則って説明します．頻度主義とは何かについては後ほど説明しましょう．

これはμがaからbの間にある確率は95%の確率，という意味ではありません．というのも，母集団は確定的なものなので，母平均も(私たちが知らないだけで)確定した一つの値をもつ定数であり，変数ではないからです．μが定数なら，a,bを定めたときには$a \leqq \mu \leqq b$は成り立っているか，成り立っていないかであり，具体的にa,bを定めた後に，$a \leqq \mu \leqq b$が成り立つ確率を考えることはできません．

そもそも「$a \leqq \mu \leqq b$が成り立つ確率は95%」という主張は，

$$ P( \overline{X} -1.96\sqrt{\frac{\sigma^{2}}{N}}  \leqq \mu \leqq \overline{X} +1.96\sqrt{\frac{\sigma^{2}}{N}}) = 0.95 $$ 

から生まれています．ここで，μを囲む左右の式，$\overline{X} -1.96\sqrt{\frac{\sigma^{2}}{N}}$も，$\overline{X} +1.96\sqrt{\frac{\sigma^{2}}{N}}$も確率変数であることを理解しましょう．つまり，サンプルを取ってくるたびにこれらの値は1つに決まるのです．ということは，$ \overline{X} -1.96\sqrt{\frac{\sigma^{2}}{N}}  \leqq \mu \leqq \overline{X} +1.96\sqrt{\frac{\sigma^{2}}{N}}$という不等式も確率変数と見なせます．つまり，この不等式が成り立つことをA=1,成り立たないことをA=0などとおけば，Aはサンプルを取ってくるたびに値が決まる確率変数なのです．

そうして十分にサンプルをとってくれば，この不等式が成り立つサンプル，つまりA=1となったサンプルは全体の95%になる，というのが，

$$ P( \overline{X} -1.96\sqrt{\frac{\sigma^{2}}{N}}  \leqq \mu \leqq \overline{X} +1.96\sqrt{\frac{\sigma^{2}}{N}}) = 0.95 $$ 

の主張です．そこで特定のサンプルの値を代入した $a \leqq \mu \leqq b$については，値が定まった今や，これが成り立っているか，いないかは確定しているけれども，適当にサンプルを選んだときにA=1となる確率は95%なので，その意味で$a \leqq \mu \leqq b$は95%で成り立つ，という言葉を使っています．

## 7.13

それでは母分散$σ^2$が分からないときはどうしたら良いか，という問題を次にやっていきます．