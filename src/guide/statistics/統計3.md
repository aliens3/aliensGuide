---
layout: layouts/post.njk
---

スタチンの論文を読んでみる
https://www.nejm.org/doi/full/10.1056/nejm199511163332001


３つの道について，

1. モチベーション，つまり今までの話の問題点やこれからの課題
2. 最終的に何をしたいのか
3. これからどんなことをやるのかの概要

を記す．各項目は詳しく別のページに書く．最終的には，統計学6まで．しかし，1つを10-15分で読める分量に分割するともっと分けられそうではある．

3までの内容と，3つのそれぞれを書くのは，独立して行えそうなので，ここまでの概要をふまえて書いていってでいいだろう．

![グーグル写真](https://lh5.googleusercontent.com/Vv8mzWIYpQdUW0oFZi09LAG93nXv-G8R5b-pilHORkJuEPgIOLJPSGyjZNFfcZXgkLY=w2400)

## 正規分布以外の確率分布は？

### 正規分布がなぜ分布の王様なのか

- 正規分布の[公理的導出](https://www.eng.niigata-u.ac.jp/~nomoto/7.html) => ランダムイベント　測定誤差とかは正規分布
- 身長がなぜ正規分布とみなせるのかを二項定理から説明　それゆえ多くの多因子遺伝は正規分布に従うことを主張できる
- 中心極限定理

### 他の様々な分布をサイコロ投げから派生させて網羅的に(例外はパレートくらい)

二項，指数，ポアソン，パレートくらいまでを重心おいて．
ほかはこれらとの関連を考えて．


- 二項分布
○×テストで，理解していると言えるためには何割正解基準にすればいいか？ 大数の法則も絡んでくるはず
http://www.math.sci.ehime-u.ac.jp/~ishikawa/kkk-12-4.pdf
あとは身長など多遺伝子

打率については👇も参照
https://www.osaka-gu.ac.jp/php/satoma/2013/E06/0625-minami07.pdf

- 指数分布
QC信頼性の9章

- ポアソン分布
待ち行列👇　ここはMCMCでの話にも絡んでくる obsidian 待ち行列も参考に
https://info.ouj.ac.jp/~maps17/11/11Queueing_pat.pdf

- パレート分布
ノードを完全にランダムにつなげてネットワークをつくると，各ノードのdegree(# of connections to other nodes)はポアソン分布となる．
(ポアソン分布になるのは直観的にはノードをつなぐというランダムなイベントが一定確率で起こるわけで，それを何回体験するかはポアソン分布になる)
一方，ノードをつなぐときに，既存のノード数に比例する確率でつなげてネットワークをつくると，degreeはパレート分布になる．
https://rikunora.hatenablog.com/entry/20091130/p1
4.1 Barab´asi-Albert 模型(スケールフリーをつくるための模型 上と同じ話　この場合 k=3になる．) =>  https://mercury.yukawa.kyoto-u.ac.jp/~bussei.kenkyu/pdf/03/1/9999-031210.pdf
👆についての具体的な証明は『複雑ネットワーク』に載っている．
逆にdegreeがパレート分布となるネットワークをスケールフリーネットワークと呼ぶ．
2~k~3のとき，平均は定義できるが，分散は定義できない．この場合ブラック・スワンが生じるし，平均の周りいくらでも離れるので，スケールがない．
https://www.jsums.edu/nmeghanathan/files/2015/05/CSC434-Fall2014-Module-6-Scale-Free-Networks.pdf



- 幾何分布
全然練習していない特技の発表会で，何回失敗を許してもらえればいいか．逆に3回失敗しても良いなら成功率をどれくらいまで高めておけば十分か．
例)あるアイドルがいる．彼女は，MV撮影で，けん玉の大技に挑戦しないといけない．練習量は最小限に抑えたい．
5回までなら失敗してもなんとか許されることが予想された．この大技の成功率をどれくらいまで高めておけばいいか．

- 負の二項分布
古代人類は生まれた子供のうち，40%しか成人に達しなかったとしよう．このとき，4人の成人に達するまでに何人の子供を生む必要があるか
https://www.mhlw.go.jp/toukei/saikin/hw/jinkou/geppo/nengai08/toukei2.html


生命保険を例に👇
http://www.math.sci.ehime-u.ac.jp/~ishikawa/kkk-12-4.pdf

身長についても，についても，それが正規分布になることを使った．しかしそれはなぜか？なぜ多くの現象が正規分布に従うのか？

逆に従わない例では有用な分布として他にどのようなものがあるのか？しかし，どの分布をどんな時に当てはめればいいのかは，どうやって知れば良いのだろうか？

サンプルを実際にとってくるまではわからないのだろうか？

正規分布の根拠

待ち行列，信頼性工学(ガンマ分布,ポアソン，指数，ワイブル分布)，パレート分布， cf.統計分布のobsidian

中心極限定理

## 統計的推定の考え方の難しさ　ベイズへ

[条件付き確率](https://ja.wikipedia.org/wiki/%E6%9D%A1%E4%BB%B6%E4%BB%98%E3%81%8D%E7%A2%BA%E7%8E%87?useskin=vector)
[これの7ページ目ベイズ予測分布くらいまで](http://watanabe-www.math.dis.titech.ac.jp/users/swatanab/bayes010.pdf)
[真の分布といかに近づけるかということが大事，自由エネルギー](http://watanabe-www.math.dis.titech.ac.jp/users/swatanab/math_bayes01.pdf)
[ド・メレの古典的な問題](https://onlinecasino116.com/%E5%8B%9D%E3%81%A4%E3%81%9F%E3%82%81%E3%81%AE%E7%90%86%E8%AB%96/%E7%A2%BA%E7%8E%87%EF%BD%9E%E3%83%89%E3%83%BB%E3%83%A1%E3%83%AC%E3%81%AE2%E3%81%A4%E3%81%AE%E3%83%80%E3%82%A4%E3%82%B9/)

- 確率とは何か，という話に集中する必要はない．大切なのは予測と制御であって，確率の真の姿を求めることではない．

### ベイズがうまれるまでの確率解釈の歴史

確率は賭博から始まった．賭博の対象は，主にサイコロで例えば「6のゾロ目が出る確率が1/2以上になるためには何回サイコロ2つを振る必要があるか」([ドメレの問題](https://onlinecasino116.com/%E5%8B%9D%E3%81%A4%E3%81%9F%E3%82%81%E3%81%AE%E7%90%86%E8%AB%96/%E7%A2%BA%E7%8E%87%EF%BD%9E%E3%83%89%E3%83%BB%E3%83%A1%E3%83%AC%E3%81%AE2%E3%81%A4%E3%81%AE%E3%83%80%E3%82%A4%E3%82%B9/))のような問題を考えていた．このとき，確率計算の根本には，

*事象の確率は，起こりやすさに差異が認められない全ての場合の数に対する，期待していた事象の場合の数の比率（割合）である*　—ピエール＝シモン・ラプラス,確率の解析的理論　

という考えがある．中学校で習う「根本事象は同様に確からしい(これをもう少しカッコよく，当確率の原理と呼ぼう)」という概念はまさしく「起こりやすさに差異が認められない場合」で，「すべての根本事象の数を分母に，今考えている条件に当てはまる根本事象の数を分子にとると，確率が求められる」という場合の数から確率を求める方法の根拠はこの考えにある．

これを「[確率の古典的定義](https://ja.wikipedia.org/wiki/%E7%A2%BA%E7%8E%87%E3%81%AE%E5%8F%A4%E5%85%B8%E7%9A%84%E3%81%AA%E5%AE%9A%E7%BE%A9)」と呼ぼう．

しかしこの考えには，問題がある．それは歪んだサイコロの確率はどう考えたらいいのか，もっと広く，例えばある年齢で人が死ぬ確率は何か(これは生命保険で適切な保険料や支払額を計算するために必要)など，当確率の原理が当てはまらない場合の確率はどう捉えるか，という問題だ．

そこで，出てくるのが大数の法則．もう一度載せると，


ということだった．これを利用すると，どんな事象の確率も当確率の原理を使わずに求められる．もっと言えば難しい計算もいらない．ただ，無限に施行するだけだ．なぜかと言えば，

- まず興味のある事象は施行の結果，起きるか起きないかである．
- 施行を繰り返して，起きた回数と起きない回数をカウントする．
- 無限に施行を繰り返せば，起きた回数/全体の回数 は求める確率に等しくなる．

例えば先のド・メレの問題で言えば，例えばサイコロを6回振ったときにゾロ目が出る確率が1/2以上になるかは，

- サイコロ2個を6回振ることを1つの施行と考える．
- 施行を繰り返して，6のゾロ目が出た施行の数/全体の施行の数を計算する
- 無限に施行を繰り返せば，この値は求める確率に等しくなる．

となり，もしその値が1/2より大きければ，振る回数を5回の時，4回の時と少なくしていけばよく，1/2より小さければ多くしていけばいい．
どうようにどんな事象の確率も，無限施行さえすれば求められる．

この事実から，大数の法則を使えば母集団の分布も無限サンプリングで正確に構成できることがわかる．
なぜなら，母集団の分布は，サンプリングしたときに，ある値(正確に言うとある値からある値)がでる確率と等しく，この確率は大数の法則から無限サンプリング(無限施行)で求められるからだ．

それゆえ，(実際にはできないけれども)無限施行さえすれば，真の確率と一致するのだから，確率とは相対頻度の極限のことだ，という考えに至る．これを頻度主義と呼ぼう．

ここから，母集団のパラメータは確定したものになる．なぜなら，無限サンプリングで母集団の分布は確定するのだから，仮に無限サンプリングはできないとしても，それは単に我々の無力であって，真の母集団の分布は存在し，母平均と母分散は確定している．それゆえ，それに例えば正規分布のような数学的構造を当てはめた場合には，母平均と母分散をパラメータとするわけなので，母パラメータは確定的である．となる．あとは，その母パラメータを有限のサンプリングから推測したときに，有限故に生じる偶然誤差から，それが本当に正しい確率はどれほどなのか，を調べることになる．

そこで，

- 繰り返すことのできない事象の確率は?(例えば競馬のレースは，ある馬が1等になる確率というものを普通に考えるが，レースは一度きりで繰り返すことはできない)
- 確定していても確率を考えることはある．例えば，「目の前の患者が心筋梗塞になっている確率はどれくらいか」を考える．しかし，患者が心筋梗塞になっているか，なっていないかは既に決まっている．単に我々がそれを知らないだだ．ランダム性はない以上，今までの定義でいうと確率という言葉は使えない

まず1点目については，次のように頻度主義でも解決できる．まず無限施行という考えを，一つの世界で無限回繰り返すということから，無限個の世界でのそれぞれ1回の結果を見るということに切り替える．つまり，2つのサイコロを無限回振ることは，無限個の世界で1度サイコロを振ることに等しいと考える．<marginnote>無限個の世界なんて有りえないと思うが，無限回振ることも有りえないので，世界の個数のありえなさをとるか，試行の回数の有りえなさをとるのかの問題である．もちろん，世界は2つでもつくることができないが，施行は2回なら行えるので，世界のほうが受け入れがたいかもしれない．しかし競馬のレースは2回も行えないし，人生を2回送ることもできない以上，施行のほうが簡単とも言い切れない．</marginnote>こう考えれば，1つの世界で1度しか行えない事象であっても，事象が起こった世界の数/全世界の数で計算できる．

2点目についても，このような形而上学的方法で，この問題を頻度主義を保ったまま救う方法はあるだろう．が，それについてはやらない．

むしろ，2点目の問題で重要なのは，今確率という言葉を使うのが正確かどうかということではなく，患者が本当に心筋梗塞なのかを正しく判断し，適切な治療を選択して，患者の状態を良くすることだろう．

そこで，確率とは「主体が抱く信念の度合い」([Bayesian_statisticsより](https://en.wikipedia.org/wiki/Bayesian_statistics?useskin=vector))として，これが適切な意思決定のために役立つことを見ていこう．

### ベイズの定理まで 尤度比 検査 カットオフ スクリーニング

条件付き確率を定義する
\\( P(A\mid B)=\frac {P(A\cap B)}{P(B)} \\)
ならば，
[mathjax AかつB二通りで]
それゆえ，
[mathjax ベイズの定理]
これをベイズの定理と呼ぶ．

これを用いて，心筋梗塞かどうかを判断する方法を考えよう．

### 母パラメータをベイズ推測

心筋梗塞はなってる，なっていないの1,0なので，事前確率は実数だった．
一方，母パラメータの信念はパラメータが実数全体を取るので，事前確率は分布になる

https://r-tips.hatenablog.com/entry/beta-distribution

コイン投げを例に積分できる例

一般的な困難と共役👇　積分困難
https://en.wikipedia.org/wiki/Conjugate_prior?useskin=vector

ここからMCMC,階層モデルを別の章で．
obsidian 2022-09-19も参照に

### 予測と制御が大切という観点で考えるなら，どの解釈が正当化をそれ自体で判断することはできない．

確率を頻度の極限と設定するのであれ，主体が抱く確率とするのであれ，どちらも真の確率分布とは一致しない．(もちろん無限施行ができれば一致するが，それができない以上，現実的にはどう解釈しても真の確率分布と一致することはない)大切なのは，予測と制御，今の場合は真の確率分布に近づける(そうすれば，あるイベントが発生する確率を正しく予測できることになる．もし求めた分布が大きくずれていれば予測は役に立たない)ことであることを考えれば，どう解釈するのが良いかという問題は(予測と制御を目的とする限り)それ自体としては考える必要はなく，真の確率分布に近づけるためにはどんな方法が最適かを考えればいいだろう．


神様視点での既知性(母集団の確定性)と，私たちの未知性の両義性(サンプルのゆれ，確率変数であること)を意識しないといけない．推定の時に分かるμの範囲は，真ん中がミューとしてもっとも有り得そうということは言えない．(少なくとも頻度主義に考えるなら．最尤法は頻度主義でない)あくまで，できた範囲に95%の確率でμが含まれるということ．しかし，普通に考えると，ミューとして最もありえる値とか，そういうことを考えたくないか？これまでの考えに厳密に従えば，「ミューとして最もありえる値」というものは考えられない．ミューは確定した値なので．

しかし確定していたとしても，普通に確信の程度として確率は使うだろう．

## 因果

細かい話は書いているものがすでにあるので，これまでの流れ(実はRCTだったこと)を振り返って何をしていたのかを分析して，
因果推論の根本にあるexchangeabilityを理解して，それを達成する方法，達成を阻害する交絡などの観点から話す．

### ふつう，条件付き確率，回帰は因果を表さない

薬Zの発売後に，用量と身長の伸びに関係があったとしよう．このとき，いえるのか？回帰 y=ax+bでa,bが固定されていてxだけが動いたけっかなら良い．しかしxが大きくなったときに，a,bも動いているなら何の意味もない．回帰の傾きが因果効果と見なせるためにはどういう条件が成立していればいいのか？因果関係論の話へ．


exchangeabilityが必要
https://www.krsk-phs.com/entry/counterfactual_assumptions#fn-e5782037

Conditional Exchangeabilityを達成する方法とバックドア基準の違いは？

Y_{a=1} - Y{a=0} が P(Y| do(A))と同じ意味合いだろう多分

### いつ，条件付き確率，回帰は因果を表すのか do operator




### DAGとは何か DAGがどうであれば　条件付き確率 = do とみなせるか

doと見なせた場合の式👇
https://towardsdatascience.com/causal-effects-via-the-do-operator-5415aefc834a

いろいろなバイアス👇交絡 自然実験(回帰分断デザイン)や操作変数法noの話も含まれている
https://www.krsk-phs.com/entry/structural_bias
https://academic.oup.com/ndt/article/30/9/1418/2459917
操作変数法👇
https://www.krsk-phs.com/entry/propensity_score_comparison

rubin(Potential outcome whatifゼウスの例)とpearl(the book of why 構造モデル)の違いなど流派のまとめ👇
https://www.jstage.jst.go.jp/article/ojjams/34/1/34_20/_pdf

経済学の本も参考に

### バックドア基準を満たせば多変量解析の係数が因果量とみなせること

ランダム化比較試験(RCT)を実はやっていた．そもそも意思決定をしたいわけなので因果から始まるのは自然なことなのだ．しかし常にRCTを行えるわけではない．観察研究から因果を探るためにはどんな条件が必要なのか？

~~最終的な目標は「バックドア基準を満たせば、重回帰分析の係数は因果の量とみなせる」ということを理解すること． cf obsidianの因果のところ~~

むしろDAGをつかって，色々なバイアスを視覚化して整理・理解すること，いろいろな手法(操作変数法，自然実験，傾向スコアなどなど)がDAGでどう理解できるか，その一つとしてバッグドア基準も見せて，重回帰分析のところは1つのセクション程度に，主はDAGによるバイアス・手法の視覚的整理・理解．

因果推論駅の奥の方=> obsidianの因果のページも参照に






