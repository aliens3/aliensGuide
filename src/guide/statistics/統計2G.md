---
layout: layouts/post.njk
---

## 今までの流れ

1. 揺らぎゆえに，母集団とサンプルの実際の分布は一致しない
2. それゆえ，平均も一致しない．
3. それゆえ，薬の効果も一致しない．

という問題の1に対して

- 母集団とサンプルの実際の分布が一致しないというとき，ヒストグラムを比べている．
- しかし，ヒストグラムで分布を表すことはできない．
- そこで，μ=母集団の平均，σ=母集団の標準偏差，とした正規分布を母集団の分布に当てはめた．

## 確率変数

これより，母集団から1人ランダムサンプリングしたとき，その人の身長がXcmとなる確率は，その母集団の平均をμ，標準偏差をσとする正規分布<small>(これを<b>N(μ,σ)</b>で表します．)</small>で与えられます．この事実を「Xは正規分布N(μ,σ)に従う」とか「Xは正規分布N(μ,σ)で生成される」と言い， $X \sim N(μ,σ)$ で表します．

一般的に，Xのようにある値をとる確率が，ある関数によって定められているものを**確率変数**といいます．そして確率変数が，ある値をとる確率を定める関数が**確率分布**です．この例ではサンプルの身長Xcmが確率変数で，正規分布N(μ,σ)が確率分布です．

<div class="leading-5 text-sm pt-2">母集団の身長データは確定したものであり，確率変数ではないことに注意してください．一人一人の身長は決まったものでランダムに動くことはありません．そこからランダムサンプリングすることがサンプルの身長Xを確率変数としています．</div>

さて，N人を正規分布N(μ,σ)からランダムサンプリングすることを考えましょう．このことは正規分布N(μ,σ)からN個のデータを生成するとも言っても同じです．

例えば，Dr.Kの実験では薬群，プラセボ群に割り当てられた50人は，母集団からランダムサンプリングで得られた50人だと考えることができました．

![薬を使った母集団からランダムサンプリングで得られた50人だと考えることができること]()

サンプルのk人目の身長を $X_k$ とすると， $X_k \sim N(μ, σ)$です．特に，薬群からの場合は $X_k \sim N(μ^D, σ)$となります．そして，この50人の平均 $\overline{X}$<small>(一般には<b>サンプル平均</b>と言います．）</small>は，

$$
\overline{X} = \frac{1}{N} \sum_{k=1}^{N} X_k
$$
で計算されます．薬群の場合はサンプル数N=50です．平均 $ \overline{X}$のように，確率変数 $X_1,X_2 \cdots X_N$を用いて計算される，サンプルの分布の特徴を示す値のことを統計量といいます．他の統計量として，

$$
S^2 =\frac{1}{N-1} \sum_{k=1}^N (X_k - \overline {X})^2
$$
で定義される不偏分散 $S^2$があります．なぜ普通の分散のように分母がNではなく，N-1なのかは[こちら](https://manabitimes.jp/math/1035)を参照してください．今後使う統計量はこの2つだけです．

## 正規分布のいくつかの性質

ここで，正規分布には次の性質があります．

<div class="text-2xl pt-8 pn-2">A:和に関する再生性　</div>

確率変数X,Yが独立で
 $X \sim N(\mu_1,\sigma_1^{2})$
 $Y \sim N(\mu_2,\sigma_2^{2})$
のとき，
 $X + Y \sim N(\mu_1 + \mu_2, \sigma_1^{2} + \sigma_2^{2})$

<div class="text-2xl pt-8 pn-2">B:定数倍に関する再生性　</div>

確率変数Xが
 $X \sim N(\mu,\sigma^{2})$
のとき，
 $aX + b \sim N(a\mu + b,a^2\sigma^{2})$

<div class="text-2xl pt-8 pn-2">C.標準正規分布　</div>

確率変数Xが
 $X \sim N(\mu,\sigma^{2})$
のとき，
 $\frac{X-\mu}{\sigma} \sim N(0,1)$

このように，Xを $\frac{X-\mu}{\sigma}$ に変換することを標準化するという．

証明はいずれも[このサイト](https://risalc.info/src/st-normal-distribution-summary.html#rep)を参照してください．{.pb-10}

事実A.B.から $X_k \sim N(μ, σ)$なら，

$ \overline{X} = \frac{1}{N} \sum_{k=1}^{N} X_k \sim N(\mu,\frac{\sigma^{2}}{N}) $

を示せます．<small>(この証明は，A.B.を使えば簡単に示せるので，わからないければぜひ確認してください．証明は[同じサイト](https://risalc.info/src/st-normal-distribution-summary.html#rep:~:text=%E8%A8%BC%E6%98%8E%E3%82%92%E8%A6%8B%E3%82%8B-,%E6%A8%99%E6%9C%AC%E5%B9%B3%E5%9D%87%E3%81%AE%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83,-%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83)にあります．)</small>

これは正規分布からN個サンプルをとることを繰り返して，サンプル平均の分布を作っていくと，サンプル平均もまた，正規分布に従うことを表しています．

![サンプル平均が正規分布となること]()

そして，その分散は1/Nになり，標準偏差$\sqrt{\frac{\sigma^{2}}{N}}$になります．つまり，N個の平均を取ることで，サンプル平均は，真の値μからの散らばりが小さくなるのです．これは直観に一致します．サンプル平均の標準偏差のことを一般に<b>標準誤差</b>と言います．なぜ誤差というのかは後で説明します．

これよりサンプルのデータ数を無限に大きくしていけば，サンプル平均$\overline{X} $と母平均μの差はいくらでも小さくなることが予想されます．これは大数の法則の特殊な場合です．

<details class="bg-red-50 my-8 p-4 ">
<summary class="text-2xl">
> 大数の法則
</summary>
独立同一分布に従う$X_1,X_2,X_3 \cdots X_n$について 分布の平均を $ \mu $ とすると，サンプル平均
$$
{\overline{X}}_n = {\frac{1}{n}} (X_1+X_2+\cdots +X_n)
$$
について
$$
P(\lim _{n\to \infty }{\bar {X}}_n=\mu )=1
$$

この法則があるおかげで，たくさん施行して平均を取れば，真の値と一致することが主張できます．例えば，公平なコインを投げ続ければ，オモテ・ウラは1/2ずつ出ることを主張できますし，逆にたくさん投げても1/2にならないなら，不公平なコインだと言えます．

<a href="https://ja.wikipedia.org/wiki/%E5%A4%A7%E6%95%B0%E3%81%AE%E6%B3%95%E5%89%87?useskin=vector" target="_blank" rel="noopener noreferrer">wikipedia</a>も参照してください．

</details>

さらに，事実Cを使えば，

$$ z = \frac{ \overline{X} - \mu }{\sqrt{\frac{\sigma^{2}}{N}}} \sim N(0,1) $$ 

が示せます． $N(0,1)$ を標準正規分布といいます．

## 標準正規分布を見ていく

標準正規分布はμ=0,σ=1とパラメータに具体的な数を代入しているので，グラフの形が一つに決まります．

![正規分布と標準正規分布のグラフ]()
 $f(x)= \frac{1}{\sqrt{2\pi}}e^{\frac {-x^2}{2}} $ 

 $X \sim N(0,1)$ のとき，a≦X≦bとなる確率 $P(a≦X≦b)$ を[このサイト](https://www.geogebra.org/m/AxtegHsz)で色々なa,bを代入して求めてみてください．とくに次の代表的な値はよく使います．

![z_aの代表例]()


<div class="text-sm leading-5">
一般的には，標準正規分布は $f(x)= \frac{1}{\sqrt{2\pi}}e^{\frac {-x^2}{2}}$ なので， $\int_a^b f(x) dx$ を計算することで $P(a≦x≦b)$ を求めることができます．しかし[計算結果を示してくれるサイト](https://keisan.casio.jp/exec/system/1402634507)があるので，典型的な値を覚えておけば，表を見る必要はありません．このサイトの内側累積確率Pとは$P(a≦X≦b)$を表します．

</div>

以上の話を踏まえると，サンプル平均から母平均を定量的に推定することができます．まず，

 $X_k \sim N(μ, σ)$ならば， $ \overline{X} \sim N(\mu,\frac{\sigma^{2}}{N}) $ で，$z = \frac{ \overline{X} - \mu }{\sqrt{\frac{\sigma^{2}}{N}}} \sim N(0,1)$でした．

例えば$P(-1.96≦z≦1.96)= 0.95$ ですので，zに $\frac{ \overline{X} - \mu }{\sqrt{\frac{\sigma^{2}}{N}}}$を代入すれば，

$$ P( -1.96 \leqq \frac{ \overline{X} - \mu }{\sqrt{\frac{\sigma^{2}}{N}}}  \leqq 1.96) = 0.95$$ 

となり，これを変形して，

$$ P( \overline{X} -1.96\sqrt{\frac{\sigma^{2}}{N}}  \leqq \mu \leqq \overline{X} +1.96\sqrt{\frac{\sigma^{2}}{N}}) = 0.95$$ 

です．Dr.Kの実験の薬群の場合には， $ \overline{X} = 115$ , $N = 50$ , $\mu = \mu^D$ です．ここで母分散$\sigma^2 = 5.4^2$を神様に教えてもらったとしましょう．すると，

$$ P( \overline{X} -1.96\sqrt{\frac{\sigma^{2}}{N}}  \leqq \mu^D \leqq \overline{X} +1.96\sqrt{\frac{\sigma^{2}}{N}}) = 0.95$$ 

となり，計算して，

$$ P( a \leqq \mu^D \leqq b) = 0.95$$ 

がわかります．このことは，何を意味しているのでしょうか．

直観的には「95%の確率で$a \leqq \mu^D \leqq b$である」と考えたくなりますが，$\mu^D$は確定した値(神様によれば1.1)なので，Dr.Kのサンプル平均から計算されたこの区間に$\mu^D$は入っています．同様にDr.H,Dr.Mの結果についても，計算された区間に$\mu^D=1.1$は，入っているか，入っていないかのどちらかであり，95%の確率で入っているということはありません．

正しい解釈としては，

1. サンプルを取ってくるごとに，$z=\frac{ \overline{X} - \mu }{\sqrt{\frac{\sigma^{2}}{N}}}$の値が確定します．μとσの値は私たちは知りえませんが，確定した値なので，私たちが知らないだけで，zの値はサンプルを取ってきた時点で決まっています．神様であれば母平均と母分散の値を使って，この値を計算できるでしょう．
2. $z\sim N(0,1)$です．つまり，サンプルをとることを繰り返して，zの分布をヒストグラムにしていけば，N(0,1)によく当てはまるものになります．
3. $z\sim N(0,1)$より，例えば$P(-1.96≦z≦1.96)= 0.95$です．つまり，サンプルをとってきて，zの値を計算すると平均して100回に95回は，それは-1.96から1.96の間に入っています．
4. $P(-1.96≦z≦1.96)= 0.95$と，$P(-1.96≦z≦1.96)= 0.95$が表すことは数学的に変形しただけで全く同じなので，サンプルをとってくることを繰り返すと，100回に95回は-1.96≦z≦1.96が成り立つように，100回に95回は，この不等式が成立します．

これを図にすると次のようになります．計算されたある区間に$\mu^D$が入っているかどうかは確定的に決まっていますが，サンプルを取ることを繰り返して，区間をたくさん求めれば，$\mu^D$を含む区間の割合は95%になるということです．

![確定した平均の値]()

ここで，100回に95回という割合をもっと厳しくしたければ，例えば$P(-1.96≦z≦1.96)= 0.99$とか，$P(-1.96≦z≦1.96)= 0.99$などを使って同様の計算をすればよいです．割合を厳しくするたびに，つまり，$P(-α≦z≦α)= p$のpの値を1に近づけるほどに，αの値は大きくなります．それゆえ，そこから推定される母平均の範囲も大きくなります．なぜなら，最終的に推定される範囲は， $P( \overline{X} -α\sqrt{\frac{\sigma^{2}}{N}}  \leqq \mu^D \leqq \overline{X} +α\sqrt{\frac{\sigma^{2}}{N}}) = p$

となるからです．ここでサンプル平均の標準偏差=標準誤差$\sqrt{\frac{\sigma^{2}}{N}}$がα倍されていることに気づきましょう．ここから，αの値が同じでも，標準誤差が大きいと，推定される母平均の範囲も大きくなる，つまり，誤差が大きくなることが分かります．これは，例えばサンプル数Nが少なかったり，母分散$\sigma^2$が大きいときに起こります．

これで，サンプルから不確実性，揺らぎを含めて母平均についての情報を求めることができました．つまり，

1. 揺らぎゆえに，母集団とサンプルの実際の分布は一致しない
2. それゆえ，平均も一致しない．
3. それゆえ，薬の効果も一致しない．

という問題に対して，分布を直接比べることはやめて，サンプルを正規分布から生成するデータとみなしました．すると，サンプル平均も正規分布に従うことが数学的に示せました．これを使って，サンプル平均から母平均を推定しました．そして，許容できる不確実性に応じて，αの値を調節して，それに応じて推定される母平均の区間が変動しました．つまり，許容できる不確実性を小さくすれば(=pを1に近づければ)，(αが大きくなるので)区間を広くとることになるのです．また，標準誤差の考えからサンプル数を大きくすれば揺らぎが少なくなるという直観も説明することができました．

しかし，実際には母分散$σ^2$も知ることはできないので，この場合にどうすればいいかを次に考えてみましょう．

Dr.H,Dr.Mの実験結果からも同じようにプラセボ群含めて計算した結果はこちらを参照してください．

ここまでの内容は，説明を省略，簡略化した箇所もとても多いので，[このサイト](https://bellcurve.jp/statistics/course/#step1)の11~12,14,16~20も参考にしてください．

