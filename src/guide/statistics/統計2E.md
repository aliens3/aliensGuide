---
layout: layouts/post.njk
---

## 問題点の確認

前回の問題点を確認します．

1. 揺らぎゆえに，母集団とサンプルの実際の分布は一致しない
2. それゆえ，平均も一致しない．
3. それゆえ，薬の効果も一致しない．

これらの問題の根本は1.にあることが分かります．そこで，この問題1を詳しく分析しましょう．

問題1が生じていたときに私たちが行っていたことは，サンプルのヒストグラムと母集団のヒストグラムを比べることです．

![サンプルと母集団のヒストグラムを比べる，母集団は正解]()

しかし，そもそも母集団のヒストグラムの表し方には恣意性があります．つまり，階級の幅や区切りの付け方をどうするのかという問題です．

![母集団のヒストグラム，幅を変えたもの，図AAA]()

ということは，母集団のヒストグラムが正解の形で，サンプルの分布がそれに近いのか，と考えることすら実は怪しい基盤の上に経っているのです．これでは揺らぎ問題に立ち向かうことはできません．

極端な話，階級の幅を∞にすれば全ての分布は完全に一致します．

![いろいろな集団のヒストグラム，幅を無限にしたバージョン]()

では，階級の幅をできるだけ細かくすればいいのでしょうか．実際のサンプルでこれをやると，幅を小さくしたほうがむしろデータの読み取りができなくなります．

![サンプルで幅を小さくしていく]()

では，丁度いい幅はなにか？となりますが，もっと別の角度から攻めてみることにしましょう．**ヒストグラムを一般化する**のです．

例えば先ほどの階級幅をいろいろな値にしたものをもう一度見てみます．

![図AAAと同じ]()

それぞれのヒストグラムの，一つ一つのバー(縦棒)が表していることは次のようなことです．

![図AAAに確率を書き込んだもの]()

ということは一般的にはヒストグラムのbar一本一本が表していることを一般化すると，

\\( P(a \leqq x \leqq b ) \\)

となることが分かります．これはxの値がaからbとなる確率ということです．これで階級の幅を∞にする問題にも対応できます．

![いろいろな集団のヒストグラム，幅を無限にしたバージョンに対して反論]()

そこで分布をヒストグラムで表すかわりに，

\\( p(a,b) =  P(a \leqq x \leqq b ) \\) 

となる，関数p(a,b)で表すことにすれば，階級の幅や区切りの位置などの恣意性がなくなります．関数とはなにかについてはこちらにまとめたので，以降の記述が分からなくなったときは参照してください．

簡単に言うと，関数p(a,b)で表すということは，a,b(ただし，aしょうなりb)となる実数a,bをpに入力すると，a x bとなる確率を返してくれるということです．ヒストグラムのbar一本一本は具体的なa,bを代入した時のp(a,b)の値であると解釈できます．

![図AAAにp(a,b)を書き込んだもの]()

このように，関数p(a,b)はすべてのヒストグラムの情報を集約したものになっています．そして神様であれば，a,bの値が与えられれば，母集団の中から，a x bとなるものをすべて集めてきて，それを母集団の要素の数で割れば，どんなa,bについてもp(a,b)を求められます．つまり，

p(a,b) = a x bとなる母集団の要素数/母集団の要素数

とするのです．しかし，この方法でp(a,b)を求めることには欠点があります．それはいろいろな集団の分布の共通性・関係性を認識できないということです．

例えば，薬軍とプラセボ群の母集団の分布をもう一度見ると，2つの分布の形は同じで平行移動した関係のように見えます．しかし，このp(a,b)の定義には形とか平衡移動のような概念が含まれないので，これらの関係を表現できないことになってしまいます．

そこで，p(a,b)を数式を用いて表すことにします．数式で表せばグラフが書けるので，形が同じとか平行移動しただけとかそういうことを語ることができます．ではp(a,b)はどう数式で表せるかですが，その前にp(a,b)が満たすべき条件を3つあげます．

\\( p(a,a) = 0 \\) ← ヒストグラムの幅を0に近づけたとき．
\\( p(a,b) + p(b,c) = p(a,c) \\) ← 確率の概念
\\( p(-∞,+∞) = 1 \\)  ← ヒストグラムの幅を∞にしたとき．

条件1は，ピッタリaとなる確率は0だということです．
条件2は
条件3は，

とくに2番目の性質がどう数式で当てはめられるか大きなヒントを与えてくれます．

\\( p(a,b) + p(b,c) = p(a,c) \\)

を満たすには，a,b,cをx軸にとって，ある関数f(x)とx軸が囲む面積とすれば実現できるのです．

![f(x)とx軸のa,b,cで囲まれた部分]()

すなわち，

\\[p(a,b) =  \int_{a}^{b} f(x) dx \\]

となるようなf(x)でp(a,b)を求めることにするのです．こうすれば，1番目は積分の性質から自動的に成立します．

\\[p(a,a) =  \int_{a}^{a} f(x) dx = 0 \\]

3番目の条件は正規化条件と呼ばれますが，f(x)とx軸で囲まれた全面積が1になるという条件になります．

では身長の分布の場合には，どんなf(x)を当てはめれば良いのでしょうか．

正規分布を当てはめれば良いことが知られています．正規分布f(x)は次のような関数です．

\\[f(x) = \frac{1}{\sigma \sqrt{2\pi}}e^{\frac{-(x-\mu)^2}{2\sigma}} \\]

この関数はどんなものか，なぜ当てはめられるのか，実際に当てはめるにはどうすればよいか，が次の問題です．
