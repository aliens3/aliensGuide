---
layout: layouts/post.njk
---

## サンプルは揺らぐ

Dr.Kは次のような実験を行い，結果を得ました．

1. ここ1週間でJ国で5歳になる100人の子供を集める．
2. 100人の子供をランダムサンプリングによって，50人ずつの2集団に分割し，薬群，プラセボ群に分ける．
3. 2群の6歳0日時の身長の平均の差+2.9cmを薬の効果とする．

![Dr.Kの実験結果](/img/stats/Dr.Kの実験結果.png)
<div class="leading-4 text-sm mt-4 pb-4">この例では，実際に母集団からランダムサンプリングすることは難しく，Dr.Kが集めたのは，ここ1週間で5歳になる子供達です．しかし，ランダムサンプリングの本質な目的は分布を同一にすることにあることを考えると，結果として分布が同じになっていれば十分なわけです．つまり，現在生まれる子供と将来生まれる子供の遺伝的・生活的な差がない=あらゆる性質について分布が同じになる，ということが合理的な仮定と見なせるなら，厳密なランダム抽出でなくても，現在の子供達は母集団と同一の良いサンプルと見なせるわけです．この仮定は十分合理的として話を進めましょう．</div>


Dr.Kはこの結果を学会で発表しましたが，この報告を聞いたDr.Hは，この結果を確かめるために全く同じ方法で追加実験を行いました．その結果，薬の効果は+1.1cmでした．

![Dr.Hの実験](/img/stats/Dr.Hの実験結果.png){.py-4}

この結果を受け，Dr.Mはさらなる追加実験を行いました．その結果は-0.4cmと，プラセボ群のほうが身長が高くなるというものでした．

![Dr.Mの実験](/img/stats/Dr.Mの実験結果.png){.py-4}

なぜ，このようなことが起きるのでしょうか．サンプルと母集団は同一なので，サンプルの結果と母集団の結果は一致するはずでした．であれば，サンプル同士の結果も一致するはずなのです．

そこで，もう一度ランダムサンプリングで同一の分布になるという理屈を見てみます．

![集団Qの分布](/img/stats/集団Qの身長分布.png)

集団Qから100人をランダムサンプリングしたときに，例えば104cm-105cmになる人は**平均して**8人サンプルされる，というのが，分布が同じになることの根拠でした．しかし，これは<stbl>平均的に期待できる話</stbl>で，実際にQから100人ランダムサンプリングしたときの結果には，この平均からの揺らぎがあるのです．これは公平なコイン投げを100回すると，だいたい50回オモテになりますが，ちょうど50回オモテになるとは限らないことと同じです．

<div class="pt-6 pb-2">集団Qからの100人のサンプルの5例</div>
<div class="overflow-y-scroll h-96" style="height: 500px;" class="pb-4">
<img src="/img/stats/sample1fromQ.png" alt="" srcset="">
<img src="/img/stats/sample2fromQ.png" alt="" srcset="">
<img src="/img/stats/sample3fromQ.png" alt="" srcset="">
<img src="/img/stats/sample4fromQ.png" alt="" srcset="">
<img src="/img/stats/sample5fromQ.png" alt="" srcset="">
</div>

こうしてみると，各々のサンプルの104cm-105cmの値は5%~13%まであり，平均して期待できる8%とは微妙にずれています．全体の分布についても同様のことが言え，各々のサンプルとQは似たような形をしていますが，全く同じ分布とはいえません．

このように，各サンプルには「揺らぎ(=サンプルごとの変動，偶然誤差)」が存在します．この揺らぎによって，Dr.K,H,Mの3者の結果が違ってしまったのです．つまり，

1. 母集団とサンプルの分布は<small>(平均的には一致するが)</small>ずれがある．
2. それゆえ，母平均とサンプル平均は一致しない．
3. それゆえ，薬の効果も一致しない．

![揺らぎの説明を図で，つまり，平均的には同じ分布であっても，実際にできる分布は違ってしまい，そこから計算される薬の効果もサンプルごとにばらついてしまったのです．]()

では，本当の薬の効果\\(\mu^D - \mu^P\\)は幾つなのでしょうか．これを知ることは，母集団に実験を行う必要があるので不可能ですが，神様にお願いして，結果を見てみましょう．

![母集団での実験結果](/img/stats/母集団の結果.png)

ちなみにDr.K,Dr.H,Dr.Mの結果の分布も載せておきます．

<div class="overflow-y-scroll h-96 my-4" style="height: 700px;">
Dr.Kの結果
<img src="/img/stats/Dr.Kの分布.png" alt="" srcset="">
Dr.Hの結果
<img src="/img/stats/Dr.Hの分布.png" alt="" srcset="">
Dr.Mの結果
<img src="/img/stats/Dr.Mの分布.png" alt="" srcset="">
</div>

これを見ると，母集団への薬の効果に近いのはDr.Hの結果だということが分かります．しかし，現実には母集団の結果を知ることはできないので，この方法で正しい結果はどれかを判定することはできません．<small>(そもそも母集団の結果が分かるならサンプルで実験する必要はありません)</small>

こうして私たちの意思決定は阻まれてしまいます．3つの対立する結果があって，このままではどの結果を信頼していいのかを知る方法が分からないからです．このサンプルの揺らぎ問題にどう対応するかが次のテーマになります．

## 一つの図にして理解する

これまでの話と直面する問題を1枚の図にまとめました．この図の意味するところが分かれば，これまでの内容についてはオーケーです．次に進みましょう．

![1枚でRCTの概要まとめ](/img/stats/1枚でRCTの概要まとめ.png)



<div class="hidden">
例えば，このような分布をする母集団からランダムに50個取り出して，分布をいくつか作ってみると，このようになります．だいたい同じ形をしていますが，細かく見ると実際にできた分布はバラバラです．つまり，同じ分布から生成されても，揺らぎのせいで実際にできる分布はそれぞれのサンプルで違うということです．しかし，私たちに観測できるのはサンプルだけですから，実際には，母集団とサンプルを見比べて，形が似ているとか違うとか考えることはできません．サンプルの分布から母集団の分布を推測することになります．

この揺らぎは直観的にも分かるように，サンプル数を少なくすれば多大に，サンプル数を多くすれば少なくなっていきます．

![サンプル少ない場合はn=3とn=10とか2つ用意 多い場合はほとんど違いが見えないくらいまで増やす 平均も載せる]()

ということは400人を集めたDr.Hのデータの方が信用できそうですが，では「どれだけ信用できるのか」つまり「400人のデータから求めた薬の効果は母集団から求める薬の効果と比べて，どれだけゆらぎがあるのか」という問いに対して定量的に，つまり揺らぎは2.1ですとか，1,3ですのように数値で答えるための方法論を私たちは，まだ理解していません．そもそも「揺らぎ」とは何かも定義していません．このように有限の揺らぐサンプルから，母集団をいかに定量的に推定するのか，これが次の課題になります．

1.のステップのランダムサンプリングはランダム抽出，2.のステップのランダムサンプリングはランダム割当と呼んで区別することが多いです．それぞれの名前の由来は，1のステップでは実際に実験の対象となるサンプルを母集団からランダムに選んでくるという意味でランダム抽出，2のステップでは介入か非介入かをサンプルのそれぞれにランダムに割り当てていくという意味でランダム割当という言葉が使われます．

薬の効果は母集団の差\\(\mu^D - \mu^P\\)で求められますが，これと同じ分布をもつサンプルの差\\(m^D - m^P\\)で薬の効果を求めても一致するだろう，ということです．小さな?マークが付いている箇所は，後で正確でないことが分かる部分です．しかし概要の考え方の方向性としては間違っていませんので今は気にせず進みましょう．
</div>