---
layout: layouts/post.njk
---

ポイントは「ある確率分布に従う確率変数から計算される統計量もまたある確率分布に従う」こと．よって確率分布，確率変数，統計量の定義を理解すること
確率分布からヒストグラムを作るのと
ヒストグラムから逆に確率分布を作るのをやる


## 課題
<iframe scrolling="no" title="正規分布" src="https://www.geogebra.org/material/iframe/id/xvtg7q4h/width/1440/height/821/border/888888/sfsb/true/smb/false/stb/false/stbh/false/ai/false/asb/false/sri/false/rc/false/ld/false/sdz/false/ctl/false" width="1440px" height="821px" style="border:0px;"> </iframe>

母集団からランダムサンプリングして得られるサンプルは揺らぎがあるために，母集団の平均差とサンプルの平均差が厳密に一致することはないし，サンプルごとに平均差は異なる．では，一致しない度合いはどれほどなのか，サンプルから真の値を定量的に推測するにはどうしたらよいか．というのが課題でした．


ヒストグラムに当てはまるデータ
https://www.geogebra.org/m/MjsYkwD7
https://www.geogebra.org/m/YFEGXGz4
https://www.geogebra.org/m/xvtg7q4h

## 母集団の分布を確率分布に当てはめる

そのための第一歩は，母集団の分布を確率分布に当てはめることです．

- 確率分布とはなにか
- 確率分布をなぜ当てはめなくてはいけないのか

を理解しましょう．

まず，いくつかの実例を見ます．

![ファイル:17歳の日本人の身長の分布.jpg](https://upload.wikimedia.org/wikipedia/commons/thumb/7/74/17%E6%AD%B3%E3%81%AE%E6%97%A5%E6%9C%AC%E4%BA%BA%E3%81%AE%E8%BA%AB%E9%95%B7%E3%81%AE%E5%88%86%E5%B8%83.jpg/800px-17%E6%AD%B3%E3%81%AE%E6%97%A5%E6%9C%AC%E4%BA%BA%E3%81%AE%E8%BA%AB%E9%95%B7%E3%81%AE%E5%88%86%E5%B8%83.jpg)

子供の出生体重

![img](https://www.hokende.com/_images/fef26a38-fce0-4715-8ebb-8aed69e024b4/562f2334c1b75.png)

大学入試の得点

![img](https://prtimes.jp/i/30937/12/resize/d30937-12-235018-1.jpg)

これらの分布は全て同じ形をしているように見えます．同じ形といっても，男女の身長の分布は全く同じ形の分布が平行移動しただけのようにみえますし，それに対して，子供の出生体重の分布は，身長と同じような形ですが，幅が身長よりも狭いように見えます．しかし，数学的な何かを当てはめなければこれ以上話を進めることはできません．例えば，女子の身長の分布は男子の身長の分布と比べて，Yの値は等しく，Xの値が5.6だけ小さいとか，幅が狭いとは，Yの値が2だけ小さいことだ，とか，そういうことを語ることはできません．

では何を当てはめればいいのでしょうか．例えば分布からは平均や分散が計算できます．しかし，これらは2つの値であって，分布がどうなっているかを表すことはありません．平均，分散に加えて，中央値とか最大値とか，どんな要約統計量を追加していっても話は同じで，これらの値をいくつ知っても，分布自体は表現できません．

そこで数学的な構造をもった分布を当てはめる必要があることが分かります．これを確率分布といいます．身長や出生体重，センター試験の点数には，正規分布という確率分布を当てはめることができます．<sidenote>なぜ当てはめることができるのか，なぜ正規分布から話をはじめるのか(実際，これからしばらくは確率分布と言えば正規分布という感じで話を進めます)については，次のセクションで正当化します．一言で言えば，正規分布は確率分布の王なのです．</sidenote>

一般的に確率分布とは何かを話す前に，正規分布で色々と実験してみます．

正規分布の数式は以下のようになります．

この式は複雑ですが，f(x)と書いてあるとおり，正規分布はxについての関数です．y=f(x)とすれば，正規分布というxの関数によってyの値を定めることができます．つまりｙはxの関数になります．「yはxの関数」というとき意味しているのは，xの値を関数に代入すれば，yの値が決まるということです．比喩的に表現すれば，関数というブラックボックスにxを入れると，特定のyの値が出てきて，同じxを入れれば，必ず同じyが出てくるということです．関数とは数式ではなく，数と数の対応を決めるものと理解しましょう．対応の表現方法の1つとして数式があるのです．

それでは，ミューとシグマは何でしょうか．これは関数のパラメータです．例えば

y= f(x) = ax+b というxについての1次関数があったとき，aとbの値を決めれば直線が一つに決まります．


パラメータが何かを考えてみます．正規分布は，身長の分布などと同様に，ある値xが発生する確率(と関係する値)yを与えるものですから，xを入れたときにyがただ一つに決まります．ということは，ミューとシグマがパラメータで，これを決めると，正規分布が一つの形に決まることが分かります．そこで，実際に動かしてみましょう．

まずミューだけを動かすと，グラフは平行移動します．そして，ミューはグラフの真ん中(一番値が大きいところ)であることに注意します．
次にシグマだけを動かすと，シグマが大きいほど，グラフの山の幅が大きくなることが分かります．

<div><div style="position:relative;padding-top:76.25%;"><iframe scrolling="no" title="Normal Distribution" src="https://www.geogebra.org/material/iframe/id/QEayZCpM/width/817/height/566/border/888888/sfsb/true/smb/false/stb/false/stbh/false/ai/false/asb/false/sri/false/rc/false/ld/false/sdz/false/ctl/false" style="position:absolute;top:0;left:0;width:100%;height:100%;"> </iframe></div></div>

正規分布を考える上では(もっと一般には確率分布を考えるときには)，正規分布の数式よりもミューとシグマ(もっと一般にはパラメータ)を動かした時に関数の形がどう変わるかを理解することが重要です．というのも，正規分布は名前の通り「分布」だからです．

そこで正規分布のパラメータを動かして，男女の身長の分布と形が同じになるように調整すると，次のようになります．


このとき，男女の身長の分布はシグマが等しく，ミューだけが　違うことが分かります．これで，平行移動させたようにみえるという最初の直観的な主張が数学的に表現できました．

しかし，同様に出生体重でも同じように確率分布を当てはめてみると，真ん中と幅を合わせることはできても，縦軸の大きさを合わせることができません．

これは，正規分布は「分布」ではあるのですが，今まで使ってきたような意味，つまり相対度数分布ではないことに起因します．これを理解します．

## 離散確率分布と連続確率分布







沖縄の梅雨明けの日にち

![img](https://quest.urban-cafeteria.com/pictures/tuyuake2.jpg)


## 同じ分布に含まれる2つの意味

前回は，集団Aからランダムサンプリングして集団Bをつくったとき，AとBはあらゆる性質において同じ分布，つまり同じ集団になるということを説明しました．しかし，それと同時に，では集団Bとして1人だけとか，2人だけとってきたときにできるものは，Aとは全く同じ分布とは言えないのではないか，ということにも触れました．この一見矛盾する結果は，「同じ分布」という言葉を2つの異なる意味で使っていることに起因します．

- 同じ確率分布によって生成される
- 実際の分布(生成された分布，サンプリングされた分布)が(なんらかの基準で)似ている．

統計的に同じ分布と言って，意味をもつのは，1番目の意味だけ．実際の分布が似ているか似ていないかを分布全体の形を比べるということはしない．
むしろ実際の分布が似ているということが，同じ確率分布から生成されていると仮定する根拠になる．これは以下の母集団当てはめのときに利用する．


## 確率分布　確率変数の定義

確率分布という言葉が出てきましたが，恐れる必要はありません．これまで扱ってきた分布の見方を変えた，実体は同じものです．
今まで扱ってきた分布の縦軸は割合でした．例えば，17歳の日本人の身長の分布を思い出しましょう．

この分布から，ランダムにサンプルをとっていくと，例えば cmの人は， の確率でサンプリングされます．この意味で，この分布は確率分布であるのです．
気をつけてもらいたいのは，この17歳の日本人の身長の分布自体は確定していることです．だからこそ，分布の縦軸には「割合」という言葉が使われています．
ここからランダムサンプリングという行為をすると，サンプルがある値になる確率を与えているとみなせるので，確率分布と言えるのです．
母集団は確定しているけれども，サンプルに対しては確率を与えている，というところが統計のポイントで区別してほしいところです．

例えば，公平なサイコロを考えましょう．このサイコロを振ったときの出る目の確率分布は次のようなものです．

だから，サイコロを1回振った時には1/6の確率で1の目がでます．

これは，前回扱った母集団から一人をランダムサンプリングすると，n/mの確率でcmの人が得られるのと全く同じ話です．


つまり，前回の分布の縦軸を度数から確率に変換したものは確率分布と等しいわけです(もちろん，母集団の分布は確定しているものなので，度数を総数で割ったものは，割合にすぎません．しかし母集団からのサンプリングという視点で見ると，この割合分布は，ある値をとる確率を表していると見なせるので，確率分布とも呼べるということです)

そして，母集団からランダムサンプリングするごとに身長は，確率分布に従う確率でいろいろな値をとります．この意味で，サンプリングで得られる身長やサイコロの目を確率変数といいます．

ここで正確な定義を導入します．確率分布とは「確率変数がある値をとる確率を定めた関数」で，確率変数とは「サンプルごとにとる値が確率的に変化する数」で，この例では「確率分布で与えられる確率に従って決まる数」です．この用語は非常に重要です．

ここで関数についておさらいしておきましょう．関数とは，あるものを他のものに対応させるもののことをいいます．学校で習う関数の多くは数式で表されますが，関数と数式は本来的には関係ありません．

「集団Aからランダムサンプリングして集団B,Cをつくったとき，BとCはあらゆる性質において同じ分布になる」というときに意味していることを正確に述べると，

- 二つのサンプルは，母集団の割合分布を確率分布として生成する．つまり，同じ確率分布から生成されている．

- このことに加えて，「十分なサンプル数があれば」実際に生成されるサンプルが「同じ形」になる．

なので，例えばBのサンプル数が少ないときには，2の意味では同じ形にはなりませんが，同じ確率分布に従って作られていることには変わりありません．

どのくらいのサンプルがあれば2つ目の意味でも分布が同じと見なせるのか，という問題はおいておきましょう．

## 母集団の分布を，数学的な確率分布に当てはめる

さて，母集団は確定した集団で，それゆえに母集団の分布・割合分布は決まっています．

しかし，その分布をそのまま見て考えることには困難が伴います．

これを説明するために，色々な分布の例を見てみます．

例えば，17歳の日本人の身長の割合分布，青色が男子で赤色が女子です．これは全数調査なので，これは母集団の分布と見なせます．このとき，女子も男子も同じ形の分布(これは同じ分布という時の2の意味)をしていて，男子の分布は女子の分布を右にスライドさせたもの，つまり平均が大きくなったもの，と考えるのが自然でしょう．しかし，分布を生のまま見ると，厳密に右に平行移動した関係にはもちろんなっていないので，このような主張をすることができません．



このような同じ形をした色々な母集団をみて，それが「同じ形をしている」と判断するために，次のように解決してみます．

サンプルが同じ分布という時に，同じ分布になることを保証するのは，

同じ確率分布から生成されていること，十分なサンプル数があることでした．

後者の条件は(今は母集団なのでサンプル数とは言いませんが)母集団がある程度大きいことは分かっているとして無視しましょう．

だから，これらの分布が同じ形をしていることを主張するためには，これらの母集団が，共通する確率分布をもっている(共通する確率分布から生成されている，共通する確率分布に近似できる)と考えれば良いわけです．そのような確率分布として正規分布を考えます．

## 正規分布

正規分布は数式で表された確率分布です．確率分布とは関数でしたから，正規分布は数式で表された関数になります．これが非常に重要なポイントです．

というのも，関数は数式で表されるのなら，関数の形をきめるパラメータが有限個しかないからです．

具体的に言うと，例えばy=ax+bという1次関数のグラフを考えます．

このとき，aとbがこの関数の形(=どういうグラフになるのか)を決めるパラメータです．つまり，a=1,b=-1のようにa,bの値を決めると，y=x-1という一つの決まったグラフができるからです．

問題 y= a^2x + bx + c という2次関数, (x-a)^2 + (y-b)^2 = r^2という円のパラメータは何？　結局，x-yグラフにかける関数なら，x,y以外の未知数が一つの数に確定すれば，xを代入した時にyの値も(複数個ある可能性はあるが)確定するので，グラフも確定する．だからx-yの平面グラフではx,y以外の未知数がパラメータと思えばいい．

同様に，正規分布の数式は以下のようになります．

この式は複雑ですが，パラメータが何かを考えてみます．正規分布は，身長の分布などと同様に，ある値xが発生する確率(と関係する値)yを与えるものですから，xを入れたときにyがただ一つに決まります．ということは，ミューとシグマがパラメータで，これを決めると，正規分布が一つの形に決まることが分かります．そこで，実際に動かしてみましょう．

まずミューだけを動かすと，グラフは平行移動します．そして，ミューはグラフの真ん中(一番値が大きいところ)であることに注意します．
次にシグマだけを動かすと，シグマが大きいほど，グラフの山の幅が大きくなることが分かります．

<div><div style="position:relative;padding-top:76.25%;"><iframe scrolling="no" title="Normal Distribution" src="https://www.geogebra.org/material/iframe/id/QEayZCpM/width/817/height/566/border/888888/sfsb/true/smb/false/stb/false/stbh/false/ai/false/asb/false/sri/false/rc/false/ld/false/sdz/false/ctl/false" style="position:absolute;top:0;left:0;width:100%;height:100%;"> </iframe></div></div>

動かしてみると分かるように，このグラフは，ミューの値がグラフの値が一番高くなっているちょうど真ん中に等しくなり，シグマの値は，山の幅を決めていることが分かります．

そこで，例えば，男女の身長の分布については，正規分布を当てはめると，次のように言えそうです．

![男女の分布は，シグマの値はほぼ同じで(山の幅は同じ)ミューの値だけが違う]()

![赤ちゃんの分布，センター試験の点数，沖縄の梅雨明けは，σとミューを調整すればいける]()

こうして，ここまで見た全ての分布が同じ分布から生成されているといえます．同じ分布とはもちろん正規分布のことです．
違いは，ミューとシグマという二つの値，パラメータだけによるものです．

これが数式を使う威力です．もし数式を当てはめないまま，生のままで，これらの分布を見ていても，似ていることは分かっても，
何が同じで，何が違うのか，を明確に表すことは困難でしょう．しかし今や，同じとは正規分布から生成されている(近似できる)ことで，違いとはミュー，シグマの値の違いです．こうして諸々の現象を統一的な視点で考えることができます．これが母集団に確率分布を当てはめる，もっとも大きな利点です．

ここで明晰なる読者の1人は「しかし，正規分布と同じような形になる分布は色々あろう，例えば，見た目にはほとんど変わらず，パラメータはミューとσ，ミューが真ん中になって，シグマが山の幅を決めるような数式もあるのではないか，その中からどうして正規分布を特別に当てはめようと思うのだろうか」という疑問をもつかもしれない．この正当な疑問は，もちろん解決可能ですが，それは後ほどやりましょう．

## 正規分布を数学的に正確に理解する


### 正規分布の確率の表し方

利点が分かったところで正規分布について，もう少し見ていきましょう．

先程「正規分布は，身長の分布などと同様に，ある値xが発生する確率(と関係する値)yを与えるものですから，xを入れたときにyがただ一つに決まります．」と書きました．ここで，「ある値xが発生する確率y」と書かないで，関係する値としたのは，yはxが発生する確率ではないからです．

再び身長の分布に例を取ります．身長の分布の一つ一つの棒グラフは割合・そこからサンプルするなら確率を表しますが，その確率は例えば cmになる人です．つまり，値に幅があります．これは当然のことで，身長は連続的な値をとるものなので，完全にピッタリ170cmということはありえないからです．ピッタリ170cmに見えても，実際は，170.00719・・・cm(=Xとしましょう)のような値だったりするでしょう．そしてピッタリXcmになる別の人は，いないでしょう．

つまり，連続的な値をとる以上，そのうちの一つの値をとる確率を考えることはできず， cm~cmのようにある範囲を取る確率だけが意味を持つわけです．そこで例えば，身長に当てはめた正規分布において，cmかcmまでを取る確率は

![数式]()

となります．一般には　となります．

### もとの分布の階級の幅を狭めていけば確率分布が得られること 平均と分散

積分はグラフの下の面積を表すので，もとの母集団の割合分布との関係を表すと次のようになります．

![幅を1にして母集団の分布を取れば，グラフの下の面積はだいたいグラフの高さになるので，分布とグラフの高さが一致する]

![一方，例えば幅を2にして母集団の分布を取れば，グラフの下の面積は2*グラフの高さになるので，高さは半分になる]

![逆に幅を無限に小さくしていけば，正規分布に限りなく近づく．もちろん母集団に含まれる要素数から幅を小さくしていけば，それに入らないものが出てくるのでダメだが，母集団の要素数が無限なら，幅を小さくしていけば，確率分布がでてくる]

ということは，母集団の平均と分散は，正規分布に一致する．(事実1)

では正規分布の平均と分散を計算してみる，

\\[f(x) = \frac{1}{\sigma \sqrt{2\pi}}e^{\frac{-(x-\mu)^2}{2\sigma}} \\]

\\[\mu =  \int_{-\infty}^{ \infty } x f(x) dx \\]

\\[\sigma = \int_{-\infty}^{ \infty } x^2 f(x) dx - \mu^2 \\]

これは，[このサイト](良いサイトをみつけて，離散確率分布とか正規化とかの補足もできるようなやつ．)にまとめられているので，計算方法やなぜこの式で平均，分散が求められるのかを知りたい人は参照．しかし，これは単に数学の計算の問題．

こうして，ミューが平均，シグマが分散を表していることが分かる．事実1から，母集団の平均と分散もミュー，シグマとなる．というより，実際は，母集団に正規分布が当てはめられるのであれば，母集団の平均と分散を正規分布の関数に代入するだけで，うまく当てはめられるということだ．実際，赤ちゃんの分布や身長の分布に正規分布を当てはめた時のミューやシグマはこうして当てはめた．しかし，母集団は無限に存在する場合があるので，ミューとシグマは我々には知り得ないことも多い．そこでサンプルから，ミューとシグマが予測できればいい．



<div class="hidden">
    この関係は，連続関数で表された確率分布全てに言えることです．
    
    このように，身長のもとの分布と，同じ形になる正規分布を考えた時に，縦軸の値は何になるのでしょうか？同じ形と言うぐらいなので，例えばもっとも高くなっている，170cmのところは，母集団の割合分布が示すように，xxくらいなのでしょうか．実はそうではありません．
    
    正規分布の数式に例えばミューを代入すると，値は　になります．確率分布とは「」でしたから，正規分布からランダムサンプリングすると，値がミューになる確率が　になるということでしょうか．実はそうなっていないのです．そもそも正規分布において，xは連続的な値をとります．例えば身長も同様です．だから，ぴったり170という値をとることはありえません．母集団の割合分布でも割合はあくまでxxcm-yycmの人の割合であって，幅があることに注意してください．つまり連続的な値をとるものに関しては，ある特定の1つの値をとる確率をとることを考えることは不可能で，~の値をとる確率しか考えられないのです．これは例えば離散的な値をとるサイコロとの大きな違いです．
    
    それゆえ，正規分布とランダムサンプリングによってある値になる確率は，次のように結びついています．
    
    これは，つまり，グラフの面積が，その値をとる確率に結びついているわけです．ヒストグラムとの関連で言えば，ヒストグラムの幅が一定なら高さは，グラフの面積に比例しているので，縦軸の縮尺は違いますが，正規分布とヒストグラムは同じ形になります．だから割合分布の平均と，分散は近似する正規分布に一致します．
    
    
    一方，例えばサイコロの目の分布は離散一様分布と呼ばれ，次のように，ある特定の1つの値をとる確率が表されることになります．一方連続一様分布であれば，正規分布と同じように　となるわけです．
    
    確率分布について，そこから発生する確率変数の平均と分散を計算することができます．サイコロの例では，　　なので　．正規分布でも同様に計算できますが，これはただの計算なので省略しましょう．
    
    統計を学習する時に重要なのは，計算と統計を切り離すことです．数学と統計を切り離しては統計は絶対に理解できませんが，計算を切り離しても本質的なところは理解できます．
</div>

## 破壊的標本調査の例でz検定 , t検定

### 問題例

このとき，k番目のサンプルの強度の値Xは母平均ミュー,母分散シグマの正規分布に従う確率変数です．このことを


\\( X_{k} \sim N(\mu,\sigma^{2}) \\)

と表すことにします．各サンプルは独立であることに注意してください．つまり　　ということです．このことをiid(独立同一分布)と呼びます．

サンプルの平均は，

\\[ \overline{X} = \frac{1}{N} \sum_{i=1}^{N} X_k \\] 

ですが，これもまた確率変数です．「これもまた確率変数です」と言うときに意味しているのは，

- サンプルを取るごとに平均は1つに決まる．その値はサンプルを取るごとに変わる．
- それぞれのサンプルの値は正規分布という確率分布に従うので，その平均も何かしらの確率分布に従う

ということです．どんな確率分布に従う確率変数となるのかは次の事実を使うと分かります．

和に関する再生性　
確率変数X,Yが独立で
\\( X \sim N(\mu_1,\sigma_1^{2}) \\)
\\( Y \sim N(\mu_2,\sigma_2^{2}) \\)
のとき，
\\( X + Y \sim N(\mu_1 + \mu_2, \sigma_1^{2} + \sigma_2^{2}) \\)

定数倍に関する再生性
確率変数Xが
\\( X \sim N(\mu,\sigma^{2}) \\)
のとき，
\\( aX + b \sim N(a\mu + b,a^2\sigma^{2}) \\)

証明は[このサイト](https://risalc.info/src/st-normal-distribution-summary.html#rep)を参照．


この事実をまた数学的に証明できますが，単に正規分布という関数の性質で，それは例えば，sinxを微分したらcosxになるのと同じです．

この2つの事実を使うと，
\\[ \overline{X} = \frac{1}{N} \sum_{i=1}^{N} X_k \sim N(\mu,\frac{\sigma^{2}}{N}) \\] 

が示せます．証明は[同じサイト](https://risalc.info/src/st-normal-distribution-summary.html#rep:~:text=%E8%A8%BC%E6%98%8E%E3%82%92%E8%A6%8B%E3%82%8B-,%E6%A8%99%E6%9C%AC%E5%B9%B3%E5%9D%87%E3%81%AE%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83,-%E6%AD%A3%E8%A6%8F%E5%88%86%E5%B8%83)にあります．こちらの証明は，和と定数倍の再生性を使えば簡単に示せるので，わからないければぜひ確認してください．

と計算できます．つまり平均もまた，平均，分散の正規分布にしたがうのです．サンプルの平均は，各サンプルの期待値と同じ値ですが，分散は1/nになっています．つまり，平均を取ることで，散らばりが小さくなっていくのです．これは直観に一致します．これよりデータ数を無限に大きくしていけば，サンプル平均と母平均の差はいくらでも小さくなることが予想されます．これは大数の法則の特殊な場合です．

[大数の法則](https://ja.wikipedia.org/wiki/%E5%A4%A7%E6%95%B0%E3%81%AE%E6%B3%95%E5%89%87?useskin=vector)
独立同一分布に従う \\(X_1,X_2,X_3 \dots \\)について 分布の平均を\\(\mu\\)とすると，
標本平均
\\[ {\overline{X}}_n = {\frac{1}{n}} (X_1+X_2+\cdots +X_n)  \\]
について
\\[ P(\lim _{n\to \infty }{\bar {X}}_n=\mu )=1\\]

この法則があるおかげで，たくさん施行すれば，真の確率が得られることが主張できます．例えば，公平なコインを投げ続ければ，それぞれの目は1/2ずつでることを主張できますし，逆に1/2にならないなら，不公平なコインだと言えます．

しかしたくさん(無限に)施行することはできない(破壊的検査)，またはしたくない(コイントス)ので，サンプルの平均から母平均を推定することをしたいです．

ここで仮に母分散は分かっているとしましょう．この仮定は話を進めるための恣意的なもの(「仮に母分散は分かっている」が許されるなら，「仮に母平均は分かっている」とすれば問題は解決します．)ですので，母分散が分かっていない場合も後でやります．

そこで母分散は で，これを既知とします．
そしてサンプルの平均は，サンプルを取ることで計算できるので，今わかるのは，次の事実です．

- 平均 ，分散の正規分布から，Xバーという値をサンプルした

この値がでてくる確率はどれほどなのでしょうか．しかし，先程話したとおり，ある値がでる確率は連続確率分布では考えることができません．

そこで次のように考えるのですが，その前に正規化という概念をつかいます．

正規化
\\( X \sim N(\mu,\sigma^{2}) \\)
のとき，
\\( z = \frac {X-\mu}{\sigma} \\)
と定義すると，
\\( z \sim N(0,1) \\)

これも和と定数倍の再生性を使えばすぐに分かる．

https://risalc.info/src/st-normal-distribution-summary.html#rep

- 標準正規分布から95%の確率で という値が出てくる．

この1.96が2，つまり標準偏差=1の2倍と非常に近いことに注意すると，標準偏差で覚えておきたい値として，

\\( P(-2 \leq z \leq 2)\approx 0.9545  \\)
\\( P(-2 \leq \frac{X-\mu}{\sigma} \leq 2)\approx 0.9545  \\)
より，
\\( P(\mu -2 \sigma \leq X \leq \mu +2 \sigma )\approx 0.9545 \\)
が導ける．

同様に，
\\( P(\mu +  \sigma \leq X \leq \mu +  \sigma )\approx 0.6827 \\)
\\( P(\mu -3 \sigma \leq X \leq \mu +3 \sigma )\approx 0.9973 \\)
も導ける．つまり，平均から1,2,3σ離れた値までが出る確率はそれぞれ，68，95，99.7%なのだ．ここからほとんどの値は3σ以内におさまることがわかる．
これを利用した品質管理(Quality Control QCの問題は以下にある)

https://ja.wikipedia.org/wiki/68%E2%80%9395%E2%80%9399.7%E5%89%87?useskin=vector

定数倍の再生性から，

- 平均 ，分散の正規分布からは，95%の確率で という値がでてくる．

- Xバーはサンプルごとに異なった値がでるが，100回サンプルすれば，だいたい95回は　という値に入る．サンプリングを無限に施行すれば95%の割合で という値に入る．
- 今回もその95%のほうの施行に入っていると仮定しよう．さすれば， となり，これを変形してミューの範囲は，となる．

- この仮定が正しい確率は95%である．

- 以上から95%の確率で，[ミューについての不等式]が成り立つ．

このようにして，ミューに関する情報を求めることができました．

注意すべきポイント

- μは確定的な値なので，この範囲はミューの有り得そうな範囲を示すわけではない．のどこにμがあるのかを知ることはできない，範囲の真ん中にμがもっとも有りやすいとか，そういう主張はしていない．ただ95%はこの範囲のμが入るということ
- 仮定が誤っていた5%の場合は，μについての範囲の情報は間違っているが，それ以上のことは何もわからないし，いつがその5%なのかも母平均を知らない限り分からない．そもそも母平均を知っていればこんなことはやらないので，永久にわからないということになる．

これを厳しくしたければ95%のところを99.9%とかそういうふうにもっと高い値にすればよいです．



では分散が分からないときはどうするか？

変数tを
\\(t=\frac { \overline{X} - \mu } { S/{\sqrt {n}} }  \\)
で定義する．

ただし，
\\( S^2 =\frac{1}{n-1} \sum_{i=1}^n (X_i - \overline {X})^2 \\)

\\( S^2\\)はサンプル分散と呼ばれる．

このとき，tは自由度nのt分布に従う．これを

\\(t \sim t(n) \\)

と表そう．

分散を母分散ではなく，標本分散をにするとt分布に従うようになると理解できる．実際，この二つの分布は形がよく似ている．

t(n)の確率分布はf(t)はt(n)という表記の通りnのみによって決まります(パラメータがnのみ) N()を思い出す
今nはサンプル数で，分かっている=確定しているので，f(t)は決定している．ということは，

\\[\int_{-\alpha}^{ \alpha } f(t) dt = 0.95 \\]

となるアルファを求めればよく，それは数学の話(というよりも表を見れば分かるので)後は同じ理屈で

- 95%の確率で という値がでてくる．
- tの値はサンプルごとに異なるが，100回サンプルすれば，だいたい95回は　という値に入る．サンプリングを無限に施行すれば95%の割合で という値に入る．
- 今回もその95%のほうの施行に入っていると仮定しよう．さすれば， となり，これを変形してミューの範囲は，となる．
- この仮定が正しい確率は95%である．
- 以上から95%の確率で，[ミューについての不等式]が成り立つ．



[qiita](https://qiita.com/s0sasaki/items/a27e743251218777e343)
変数の置き方　https://ja.wikipedia.org/wiki/T%E5%88%86%E5%B8%83

t分布に従うことの意味をN(0,1)に従うことと同じようにイメージする．すなわち，N(0,1)のようにある確定した確率分布に従うことで，サンプルするごとに決まるこの値が，95%の確率で，特定の範囲内に入っていることが分かり，

だから，実際にt分布にこの値が従うことの証明は数学的な問題なので無視しても大丈夫．

t-分布の導出 

t-分布の数式 



破壊的標本調査の例でz検定



## 薬Zの例で仮説検定

では薬Zの例に戻ります．5歳児の身長の分布は，17歳の例を踏まえると正規分布をとると考えて良さそうです．

そして，薬を使用した群と使用しない群は，効果があればミューが変化しているでしょう．シグマの変化については，とりあえず変化しないと考えることにしましょう．

そうすると，そこからランダムサンプリングしたサンプルもこの正規分布に従うわけです．

このとき，分かるのは投与群と非投与群のサンプルの平均と分散だけです．

ここから破壊的検査の例でやったように，母集団の投与群と非投与群の母平均と母分散を推定することができます．

\\(H_0 : \mu_1 = \mu_2 \\)
\\(H_1 : \mu_1 \neq \mu_2 \\)


投与群Xk ~ N()
非投与群X'k 

こうして見ると，95%信頼区間はかぶっています．

そもそもやりたいことは薬を使うと差がでるか．ただ，かぶってしまうと，その区間のどこにミューがあるかについての情報を何も与えてくれないので，差があるかどうか言うことはできない．実際，次のような場合もありえるだろうと反論される．

差があるかどうかを調べたければ，他の方法がある．

- 薬に効果がない，差がない，平均が同じと仮定する
- 同じ分布に従うなら平均差をとってもろもろ計算したものがt分布に従うことをつかう(👇，方法等分散の場合を参照)

\\( U_e=\frac{(m-1)U_x+(n-1)U_y}{m+n-2} \\)

\\( t_0=\frac  { \lvert  \overline{X} - \overline{Y} \rvert  } {\sqrt{U_e}(\frac{1}{m}+\frac{1}{n})} \\)

https://ja.wikipedia.org/wiki/T%E6%A4%9C%E5%AE%9A?useskin=vector


個々から一般に，ある母パラメータを推定したいときには，
- サンプルから求められる統計量がある統計分布に従う(数学的にわかる性質)ことが知られている
- 統計分布と統計量には未知数として求めたい母パラメータ一つしか含まれていない
- 信頼係数を定めて，ある統計量がその確率で含まれるを区間を不等式で表す
- 不等式を変形して母パラメータがわかる

仮説検定をしたいときには，仮定をすることで母パラメータが含まれない形で分かって，統計量が区間に含まれれば矛盾なし，含まれなければ棄却となる．


## あと話すこと
- 有意差があることが効果ではない(effect sizeを!) => [このPDF](https://www.mizumot.com/method/mizumoto-takeuchi.pdf)の2.1までを読むこと
- 誤り 1,2 [wikipedia参照](https://ja.wikipedia.org/wiki/%E7%AC%AC%E4%B8%80%E7%A8%AE%E9%81%8E%E8%AA%A4%E3%81%A8%E7%AC%AC%E4%BA%8C%E7%A8%AE%E9%81%8E%E8%AA%A4?useskin=vector)で良さそう
- 否定されないからといって肯定もできない [このPDF](https://gakkai.univcoop.or.jp/pcc/2014/papers/pdf/pcc057.pdf)に使い方や結果の解釈方法がうまく載っている．
=> null hypothesisは使わない

というふうになる．

別の言い方をすれば，サンプルが従う正規分布のパラメータをサンプルから推定するということです．このパラメータは母集団から一つ定まった値ですが，サンプルの平均と分散はサンプリングするたびに偶然誤差で色々な値を取ります．

M = Σ Xk / N

S^2 = 

Xk ~ N(μ，σ)

ここで，正規分布には次の性質があることを使います．



これも純粋に正規分布という関数の数学的な性質なので統計的には既知の事実として進む．

よって，平均は次の確率分布に従うことが分かる．





このように母集団を数式で表された確率分布に近似することを正当化する根拠を幾つか述べます．

- 





しかしそれを知り得るのは神様だけです．実際に私たちが得るものはすべてサンプルです．この2つの視点を交互に行き来することは統計を理解する上で非常に重要です．

つまり，確定しているけど知り得ないのが母集団であり，その分布なのです．だから，そこからいくらたくさんのサンプルをとってきても，



所得の分布(パレート?)

![平均年収の分布から対数正規分布と確率分布・確率変数について学ぼう | ２０代サラリーマンの全方位投資](https://i1.wp.com/toushi-channel.com/wp-content/uploads/2019/04/https___www_mhlw_go_jp_toukei_saikin_hw_k-tyosa_k-tyosa16_dl_03_pdf.png?resize=744%2C622)

・母集団は確定的な集団なのだが，数学的にあつかうためには，その構造について仮定を置く必要がある．そこで母集団もある確率分布と近似・同一と考える．そもそもサンプルしか知り得ない．だから母集団の分布の細かいところがどうこうということはそもそも分からない．大まかな構造(データがどのように生成されるのか)を考える．その確率分布のパラメータは母集団の性質を反映して一つに決まっている．最尤法的な考え方．

・母集団の分布はどうやって仮定すればいいか．サンプルから．もしくはとくに身長の分布は正規分布になる理由を生物学的に説明，ベルヌーイ分布と二項分布．

・サンプルはそれに従う確率変数である．サンプルごとに，統計量は異なる．だから，2集団の統計量の差が偶然ではない差なのかを調べる必要がある．

・逆に偶然の差とはなにか．それはどちらもプラセボに置き換えた場合で考えてみよう．(もちろんどちらも薬に置き換えても話は変わらない)この場合介入後の2つの母集団は同じ．ならサンプルの差は偶然のみの差．この差が特定の値になる確率は数学的に計算できる．

・実際の差が，もし差がなかったときにはほとんど生じないような差だったら・・・　・帰無仮説とP値と有意差と意義と信頼区間と標準誤差とサンプル数

\\( X_{k} \sim N(\mu,\sigma^{2}) \\)より，\\( \sum_{i=1}^{N} X_k \sim N(\mu \cdot N,\sigma^{2} \cdot N) \\)を使うと，
\\[ \overline{X} = \frac{1}{N} \sum_{i=1}^{N} X_k \sim N(\frac{1}{N} \\] 
\\[\mu \cdot N,\frac{1}{N^2} \sigma^{2} \cdot N ) = N(\mu,\frac{\sigma^{2}}{N}) \\] 