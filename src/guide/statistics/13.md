---
layout: layouts/guide.njk
title: ベイズ・様々な確率分布・因果
order : 13
next : /guide/statistics/13
previous : /guide/statistics/11
---

## 13.1 

8.7において，<span class="border-b-2 border-green-400 inline-block">$a \leqq \mu \leqq b$が成り立つ確率は95%</span>という文が意味することを頻度主義的に説明しました．この解釈の仕方は直観的ではなく分かりづらいものです．



## 11.2  <small>ベイズがうまれるまでの確率解釈の歴史</small>

確率は賭博から始まりました．賭博の対象は，主にサイコロで，例えば「6のゾロ目が出る確率が1/2以上になるためには何回サイコロ2つを振る必要があるか」([ドメレの問題](https://onlinecasino116.com/%E5%8B%9D%E3%81%A4%E3%81%9F%E3%82%81%E3%81%AE%E7%90%86%E8%AB%96/%E7%A2%BA%E7%8E%87%EF%BD%9E%E3%83%89%E3%83%BB%E3%83%A1%E3%83%AC%E3%81%AE2%E3%81%A4%E3%81%AE%E3%83%80%E3%82%A4%E3%82%B9/))のような問題を考えていました．この時代の確率計算の根本には，

*事象の確率は，起こりやすさに差異が認められない全ての場合の数に対する，期待していた事象の場合の数の比率（割合）である*　—ピエール＝シモン・ラプラス,確率の解析的理論　

という考えがあります．中学校で習う「根本事象は同様に確からしい」という概念(これをもう少しカッコよく，<b>当確率の原理</b>と呼ぶことにします)はまさしく「起こりやすさに差異が認められない場合」で，「すべての根本事象の数を分母に，今考えている条件に当てはまる根本事象の数を分子にとると，確率が求められる」という方法の根拠は，この考えにあります．これを「[確率の古典的定義](https://ja.wikipedia.org/wiki/%E7%A2%BA%E7%8E%87%E3%81%AE%E5%8F%A4%E5%85%B8%E7%9A%84%E3%81%AA%E5%AE%9A%E7%BE%A9)」と呼びましょう．

しかしこの考えには，問題があります．例えば，

- 歪んだサイコロの確率
- ある年齢で人が死ぬ確率(これは生命保険で適切な保険料や支払額を計算するために必要)
{.pt-4}

など，当確率の原理が当てはまらない場合の確率はどう捉えるか，という問題です．

そこで，出てくるのが大数の法則で，これを利用すると，どんな事象の確率も当確率の原理を使わずに求められます．もっと言えば難しい計算も必要なく，ただ，無限に施行するだけで十分です．具体的には，ある事象Aが起きる確率を求めたければ，

- Aは施行の結果，起きるか起きないかである．
- 施行を繰り返して，Aが起きた回数と起きない回数をカウントする．
- 無限に施行を繰り返せば，Aが起きた回数/全体の回数は，Aが起きる確率に等しくなる．
{.pt-4}

ということが大数の法則から保証されます．例えば先のド・メレの問題で言えば，例えばサイコロを6回振ったときにゾロ目が出る確率は，

- サイコロ2個を6回振ることを1つの施行と考える．
- この施行を無限に繰り返して，6のゾロ目が出た施行の数/全体の施行の数を計算する．
- この値がサイコロ2個を6回振ったときにゾロ目が出る確率である．
{.pt-4}

となり，もしその値が1/2より大きければ，振る回数を5回の時，4回の時と少なくしていき，1/2より小さければ多くしていけばいって，はじめて1/2を超す回数を探せば，それが求めるべきものです．このようにどんな事象の確率も，無限施行さえすれば求めることが出来るのです．

同様にして，大数の法則を使えば母集団の分布も無限サンプリングで正確に構成できることが分かります．なぜなら，母集団の分布は，サンプリングしたときに，ある値がでる確率と等しく，この確率は大数の法則から無限サンプリング(無限施行)で求められるからです．これは，chapter4で述べたように，母集団から無限にサンプルを取ってくれば，サンプルと母集団が一致することと全く同じです．

以上から，(実際にはできないけれども)無限施行さえすれば，真の確率と一致するのだから，確率とは相対頻度の極限のことだ，という考えに至ります．これが頻度主義です．

ここから，

- 無限サンプリングすれば，母集団の分布は確定する．
- 仮に無限サンプリングはできないとしても，それは単に我々の無力だからであって，真の母集団の分布は存在し，母平均と母分散は確定している

という考えが帰結し，母集団のパラメータは確定したものになります．だからこそ，<span class="border-b-2 border-green-400 inline-block">$P(90 \leqq \mu \leqq 110)=0.95$95%</span>を，素朴にμが90から110の間にある確率が95%だと考えることができないのでした．μは確定したものなので，$90 \leqq \mu \leqq 110$は成り立っているか，成り立っていないかのどちらかですから，<span class="border-b-2 border-green-400 inline-block">$P(a \leqq \mu \leqq b)=0.95$</span>は，ある特定のサンプルについての文言ではなく，全体のサンプルのうち，$a \leqq \mu \leqq b$が成り立つものの<stbl>頻度</stbl>が95%だと言うことを言っているわけです．

しかし，頻度主義的な確率解釈にも限界があります．それは，

1. 繰り返すことのできない事象の確率についてどう考えるか
2. 確定している事象の確率について考えたいときにはどうすればいいか

ということです．

まず1点目について．例えば，競馬のレースは，ある馬が1等になる確率というものを普通に考えるますが，レースは一度きりで繰り返すことはできません．だから無限施行の相対頻度が，ある馬が勝つ確率なのだ，と主張することはできません．と常識的には思いますが，この問題は，次のように頻度主義でも解決できます．

まず無限施行という考えを，一つの世界で無限回繰り返すということから，その世界を無限個に複製して，無限個の世界での1回の結果を見るということに切り替えます．つまり，2つのサイコロを無限回振ることは，無限個の世界で1度サイコロを振ることに等しいと考えるのです．そして，ある事象が起きる確率は，その事象が起こった世界の数/全世界の数で計算します．こう考えれば，1つの世界で1度しか行えない事象であっても確率が計算できます．

無限個の世界なんて有りえないと思うが，無限回振ることも有りえないので，世界の個数のありえなさをとるか，試行の回数の有りえなさをとるのかの問題だとも言えます．もちろん，世界は2つであっても作ることができませんが，施行は2回なら行えるので，世界のほうが受け入れがたいかもしれません．しかし競馬のレースは2回も行えないし，人生を2回送ることもできない以上，施行のほうが簡単とも言い切れません．

次に2点目について．例えば，「目の前の患者が心筋梗塞になっている確率はどれくらいか」を医師は考えます．しかし，患者が心筋梗塞になっているか，なっていないかは既に決まっていて，単に我々がそのどちらなのかを知らないだけです．ランダム性はない以上，頻度主義的には，そもそもこういう場面で確率を考えることが誤っています．

ただ，心筋梗塞疑いの患者を目の前にして重要なのは，今確率という言葉を使うのが正確かどうかということではなく，患者が本当に心筋梗塞なのかを正しく判断し，適切な治療を選択して，患者の状態を良くすることでしょう．

1,2をともに解決する確率解釈の方法がベイズ主義です．そこでは，確率とは「主体が抱く信念の度合い」([Bayesian_statisticsより](https://en.wikipedia.org/wiki/Bayesian_statistics?useskin=vector))と解釈されます．この場合，繰り返すことができなくても，すでに確定していても問題ありません．例えば，ある医師が診察の結果，6割くらい心筋梗塞だと信じられるのなら，確率は60%だと考えます．

ベイズ主義的な確率の解釈は，

- 直観的な解釈が可能であること
- 幅広い事象に適応できること

にあります．そこで，実際に適切な意思決定のために役立つことを見ていくことにしましょう．

### ベイズの定理まで 尤度比 検査 カットオフ スクリーニング

ベイズの定理
\\[ P(A\mid B) = \frac {P(B\mid A)}{P(B)} {P(A)} \\]

[ベイズの定理を用いて，検査後確率を求める問題](https://codezine.jp/article/detail/14581)


### ベイズの定理の仮説統計との関連


### 母パラメータをベイズ推測

心筋梗塞はなってる，なっていないの1,0なので，事前確率は実数だった．
一方，母パラメータの信念はパラメータが実数全体を取るので，事前確率は分布になります．
つまり，母パラメータの1つをθとすればθ=1となる確率は

![母パラメータの信念分布]()

https://r-tips.hatenablog.com/entry/beta-distribution

コイン投げを例に積分できる例

一般的な困難と共役👇　積分困難
https://en.wikipedia.org/wiki/Conjugate_prior?useskin=vector

ここからMCMC,階層モデルを別の章で．
obsidian 2022-09-19も参照に

### 予測と制御が大切という観点で考えるなら，どの解釈が正当化をそれ自体で判断することはできない．

確率を頻度の極限と設定するのであれ，主体が抱く確率とするのであれ，どちらも真の確率分布とは一致しない．(もちろん無限施行ができれば一致するが，それができない以上，現実的にはどう解釈しても真の確率分布と一致することはない)大切なのは，予測と制御，今の場合は真の確率分布に近づける(そうすれば，あるイベントが発生する確率を正しく予測できることになる．もし求めた分布が大きくずれていれば予測は役に立たない)ことであることを考えれば，どう解釈するのが良いかという問題は(予測と制御を目的とする限り)それ自体としては考える必要はなく，真の確率分布に近づけるためにはどんな方法が最適かを考えればいいだろう．


神様視点での既知性(母集団の確定性)と，私たちの未知性の両義性(サンプルのゆれ，確率変数であること)を意識しないといけない．推定の時に分かるμの範囲は，真ん中がミューとしてもっとも有り得そうということは言えない．(少なくとも頻度主義に考えるなら．最尤法は頻度主義でない)あくまで，できた範囲に95%の確率でμが含まれるということ．しかし，普通に考えると，ミューとして最もありえる値とか，そういうことを考えたくないか？これまでの考えに厳密に従えば，「ミューとして最もありえる値」というものは考えられない．ミューは確定した値なので．

しかし確定していたとしても，普通に確信の程度として確率は使うだろう．


